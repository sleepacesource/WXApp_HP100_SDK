!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.medica=t():e.medica=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=21)}([function(e,t,n){"use strict";function r(e,t){i.setLogConfig(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"log",function(){return i}),t.setLogConfig=r;var o=n(22),i=new o.a({all:!1,remoteAll:!1},{log:{local:!0,remote:{available:!1,url:"ws://192.168.197.100:6010"}}})},function(e,t,n){"use strict";function r(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function o(e){var t=r(e);return JSON.parse(JSON.stringify(t).replace(/\\u\d{4}/g,""))}function i(e){for(var t=new ArrayBuffer(e.length),n=new Int8Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}function a(e){var t=[];if(!e||!e instanceof ArrayBuffer||e.byteLength<1)return t;for(var n=new DataView(e),r=0;r<n.byteLength;r++)t.push(n.getInt8(r));return t}function s(e){for(var t=new ArrayBuffer(e.length),n=new DataView(t),r=0;r<e.length;r++)n.setInt8(r,e[r]);return n.buffer}function c(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function u(e){for(var t=new DataView(e),n="",r=0;r<t.byteLength;r++){var o=t.getUint8(r);o=o.toString(16),o.length<2&&(o="0"+o),n=n.concat([o])}return n}function l(e){var t="";if(!(t=e)||t.length<2||t.length%2!=0)return new ArrayBuffer(0);for(var n=new DataView(new ArrayBuffer(t.length/2)),r=0,o=0;o<t.length;o+=2){var e=(t.substr(o,2),parseInt(t.substr(o,2),16));n.setUint8(r,e),r++}return n.buffer}function f(e,t){for(var n=[],r=0;r<e.byteLength;r++)n[r]=e.getUint8(r);var o=t?t+":":"notip:";console.log("logMsg "+o+"["+n+"] bytelen: "+e.byteLength)}function _(){for(var e="",t=0;t<arguments.length;t++)0!==t&&(e+="_"),e+=arguments[t];return e}function d(e,t){var n=[],r=a(e);if(r.length>=t.length){for(var o=0,i=0;i<r.length;i++)if(i>2)if(h(r,i,t)){var c=r.slice(o,i-1);n.push(s(c)),o=i-1,i===r.length-1&&n.push(s(r.slice(o)))}else i===r.length-1&&n.push(s(r.slice(o)))}else n.push(e);return n}function h(e,t,n){return e[t]===n[3]&&e[t-1]===n[2]&&e[t-2]===n[1]&&e[t-3]===n[0]}Object.defineProperty(t,"__esModule",{value:!0}),String.prototype.endwith=function(e){return!(null==e||""==e||0==this.length||e.length>this.length)&&this.substring(this.length-e.length)==e},String.prototype.startwith=function(e){return!(null==e||""==e||0==this.length||e.length>this.length)&&this.substr(0,e.length)==e},Array.prototype.removeItem=function(e){if(e)for(var t=this.length,n=0;n<t;n++){var r=this[n];if(r===e){this.splice(n,1);break}}},Array.prototype.triggerEach=function(e){for(var t=this.length,n=0;n<t;n++){var r=this[n];e&&e(r)}};var g=function(e){for(var t=Array.prototype.map.call(new Uint8Array(e),function(e){return e}),n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n},p=function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)}).join("")};ArrayBuffer.prototype.split=function(e){for(var t=this,n=t.byteLength,r=Math.floor(n/e)+1,o=n%e,i=[],a=0,s=0;s<r;s++){var c=a*e,u=0;u=a+1>=r?c+o:c+e,a++;var l=t.slice(c,u);l.byteLength>0&&i.push(l)}return i},ArrayBuffer.prototype.append=function(e){if(!e||0==e.byteLength)return this;if(0==this.byteLength)return e;for(var t=new DataView(new ArrayBuffer(this.byteLength+e.byteLength)),n=new DataView(this),r=new DataView(e),o=0;o<t.byteLength;o++)o<this.byteLength?t.setInt8(o,n.getInt8(o)):t.setInt8(o,r.getInt8(o-n.byteLength));return t.buffer},ArrayBuffer.prototype.mergeBuffer=function(){for(var e=this.toArray(),t=[],n=0;n<arguments.length;n++)t.push(arguments[n].toArray());return e=e.concat.apply(e,t),this.fromArray(e)},ArrayBuffer.prototype.toArray=function(){return a(this)},ArrayBuffer.prototype.fromArray=function(e){return s(e)},DataView.prototype.position=0,DataView.prototype.next=function(e){e?this.position+=e:this.position++},DataView.prototype.set1x=function(e){return this.setInt8(this.position,e),this.position++,this},DataView.prototype.set2x=function(e){return this.setInt16(this.position,e),this.position+=2,this},DataView.prototype.set4x=function(e){return this.setInt32(this.position,e),this.position+=4,this},DataView.prototype.set8x=function(e){return this.setInt32(this.position,0),this.position+=4,this.setUint32(this.position,e),this.position+=4,this},DataView.prototype.setStr=function(e,t,n){for(var r=this.position,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(i<0||i>127)for(var a=encodeURI(e[o]),s=a.split("%"),c=0;c<s.length;c++)""!=s[c]&&this.set1x(parseInt(s[c],16));else this.set1x(i)}var u=this.position-r;if(t&&t>u){var l=t-u;for(o=0;o<l;o++)this.set1x(0)}return this},DataView.NO_SIGNED=1,DataView.prototype.get1x=function(e){var t=e===DataView.NO_SIGNED?this.getUint8(this.position):this.getInt8(this.position);return this.position+=1,t},DataView.prototype.get2x=function(e){var t=e===DataView.NO_SIGNED?this.getUint16(this.position):this.getInt16(this.position);return this.position+=2,t},DataView.prototype.get4x=function(e){var t=e===DataView.NO_SIGNED?this.getUint32(this.position):this.getInt32(this.position);return this.position+=4,t},DataView.prototype.get8x=function(e){var t=e===DataView.NO_SIGNED?this.getUint32(this.position+4):this.getInt32(this.position+4);return this.position+=8,t},DataView.prototype.getStr=function(e,t){for(var n,r=this.buffer.slice(this.position,this.position+e),o=new DataView(r),i=o.byteLength-1;i>=0;i--)if(0!=o.getInt8(i)){n=i+1;break}var a=r.slice(0,n);if(!t){var s=String.fromCharCode.apply(null,new Uint8Array(a));return this.position+=e,s}var c=1,u=t.toLowerCase().replace("-","");"gbk"==u?c=2:"utf8"==u&&(c=3);var l=new DataView(a);if(2==c){for(var f="",i=0;i<l.byteLength;i++){var _=l.getUint8(i),d="";d=_<0||_>=127?String.fromCharCode(l.get2x()):String.fromCharCode(l.get1x()),f+=d}return f}if(3==c){for(var h="",i=0;i<l.byteLength;i++){var _=l.getUint8(i),d="";d=_<0||_>=127?"%"+_.toString(16):String.fromCharCode(_),h+=d}return decodeURI(h)}},t.default={str2ab:i,ab2str:r,ab2string:o,buf2hex:p,buf2string:g,hashCode:c,buffer2Arr:a,arr2Buffer:s,hex2buffer:l,buffer2hex:u,logMsg:f,buildKey:_,splitBufferBySeparator:d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ON_BLE_EVENT_NAME",function(){return r}),n.d(t,"BLE_RET",function(){return o}),n.d(t,"FRAME_TYPE",function(){return i}),n.d(t,"DEVICE_TYPE",function(){return a}),n.d(t,"MUSIC_TYPE",function(){return s}),n.d(t,"LightMode",function(){return c}),n.d(t,"OPERATION_TYPE",function(){return u});var r={ADAPTER_OPEN_CHANGED:"__onBluetoothAdapterStateChangeCallback",CONNECTION_CHANGED:"__onBLEConnectionStateChangeCallback",DEVICE_DISCOVERY:"__onBluetoothDeviceFoundCallback",CHARACTERISTIC_VALUE_CHANGED:"__onCharacteristicValueChangeCallback",POST_MSG_CALLBACK:"__postMsgHandlerCallback"},o={Boolean:{True:1,False:0},status:{suc:0,fail:1,timeout:9009},bleStatus:{available:0,close:1,unauthorized:2,unsupported:3,uninitialized:4},platform:{android:0,ios:1},connection:{connected:!0,disconnected:!1}},i={ACK:0,POST:1,Request:2,Response:3};t.default={ON_BLE_EVENT_NAME:r,BLE_RET:o,DEVICE_TYPE:a};var a={DEVICE_TYPE_RESTON_Z1:1,DEVICE_TYPE_RESTON_Z2:9,DEVICE_TYPE_RESONT_Z400:19,DEVICE_TYPE_RESTON_Z400T:22,DEVICE_TYPE_RESONT_Z4TWB:26,DEVICE_TYPE_RESONT_Z4TWP:27,DEVICE_TYPE_RESONT_Z4TWP2:37,DEVICE_TYPE_RESTON_Z300:4,DEVICE_TYPE_BINOTONE:33,DEVICE_TYPE_P300:34,DEVICE_TYPE_PILLOW:3,DEVICE_TYPE_GP300:36,DEVICE_TYPE_BLE_BRIGE:35,BRIGE:50,DEVICE_TYPE_NOX_SA1001:23,DEVICE_TYPE_NOX_SA1001_2:24,DEVICE_TYPE_NOX_SA1001_4:25,DEVICE_TYPE_EW201W:30,DEVICE_TYPE_EW201B:29,DEVICE_TYPE_EW202W:53,DEVICE_TYPE_SN913:40,DEVICE_TYPE_SN913A:41,DEVICE_TYPE_SN913E:44,DEVICE_TYPE_SN923A:45,DEVICE_TYPE_NOX_2W:12,DEVICE_TYPE_NOX_2B:11,DEVICE_TYPE_SLEEPDOT_502T:17,DEVICE_TYPE_SLEEPDOT_502:16,DEVICE_TYPE_SLEEPDOT:10,DEVICE_TYPE_NOX_PRO:2,DEVICE_TYPE_M800:38,DEVICE_TYPE_P200A:46,DEVICE_TYPE_Z400T2:47,DEVICE_TYPE_M871W:52,DEVICE_TYPE_BM8701:32777},s={INVALID:255,LOCAL:0,OUTSITE:1,XMLY_ALBUM:2,XMLY_SIGLE:3,SLEEPACE_ALBUM:4,SLEEPACE_SINGLE:5,CUSTOMIZEDXMLY_ALBUM:6,CUSTOMIZED_LOCAL_ALBUM:7},c={White:0,Color:1,Fixed_stream:2},u={GET:0,SET:1}},function(e,t,n){"use strict";function r(){this.container={},this.put=function(e,t){this.container[e]=t},this.get=function(e){var t=this.container[e];return void 0==t?null:t},this.showMap=function(){var e=[];for(var t in this.container)e.push("{"+t+":"+this.container[t]+"}")},this.remove=function(e){var t=this.container[e];return delete this.container[e],void 0==t?null:t},this.clear=function(){for(var e in this.container)delete this.container[e]},this.containsKey=function(e){for(var t in this.container)if(t==e)return!0;return!1},this.containsValue=function(e){for(var t in this.container)if(this.container[t]==e)return!0;return!1},this.keySet=function(){var e=[];for(var t in this.container)e.push(t);return e},this.values=function(){var e=[];for(var t in this.container)e.push(this.container[t]);return e},this.size=function(){var e=0;for(var t in this.container)e++;return e},this.putAll=function(e){for(var t in e.container)this.put(t,e.container[t])}}Object.defineProperty(t,"__esModule",{value:!0}),t.Map=r,t.default={Map:r}},function(e,t,n){"use strict";function r(e,t){var n=t-e,r=Math.random();return e+Math.round(r*n)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e=e.toString(),e.length<t&&(e=new Array(t-e.length+1).join(n)+e),e}function i(e){return e.replace(/[^\u4e00-\u9fa5\w]/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.randomNum=r,t.padStart=o,t.rtrim=i},function(e,t,n){"use strict";function r(){return B>=127&&(B=0),B++}function o(e,t){for(var n=[],r=new DataView(t),o=0;o<r.byteLength;){var i=r.getUint8(o),a=r.getUint8(o+1);if(o+i+1>31)break;if(0==i)break;if(e==a){for(var s=0;s<i-1;s++)n.push(r.getInt8(o+2+s));break}o+=i+1}r=new DataView(new ArrayBuffer(n.length));for(var s=0;s<n.length;s++)r.setInt8(s,n[s]);return r.buffer}function i(e){var t=e,n=void 0;return t&&t.byteLength>0&&(n=f.default.ab2str(o(255,t))),n}function a(){this.resp=!0,this.key=!0,this.callStatusMap=new _.Map,this.respDv=new DataView(new ArrayBuffer(4096)),this.respBufIndex=0,this.BUF_SEPARATOR_ARR=[36,95,64,45],this.buildMsg=function(e){var t=r(),n=e.content||new ArrayBuffer(0),o=new DataView(new ArrayBuffer(16+n.byteLength));this.buildHeader(t,1,0,e.deviceType,o),o.position=7,o.set1x(e.msgType);for(var i=this.buildCallkey(e.deviceType,e.msgType,t),a=new DataView(n),s=0;s<n.byteLength;s++)o.set1x(a.get1x());return this.buildEnder(o,n.byteLength),{key:i,buffer:o.buffer}},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,o=0,i=setInterval(function(){o++;var a=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(a=!0,n.callStatusMap.remove(e.key)):a=!0,(a||o>=r)&&(clearInterval(i),t(a,o))},5)},this.handleResp=function(e,t){if(d.log.i(v,"handleResp-start",f.default.buffer2Arr(e)),e&&!(e.byteLength<=0))for(var n=e.byteLength,r=new DataView(e),o=0;o<n;o++){this.respDv.setInt8(this.respBufIndex,r.getInt8(o));var i=this.isEndMsg(this.respDv,this.respBufIndex);if(this.respBufIndex++,i){var a=new DataView(this.respDv.buffer.slice(0,this.respBufIndex));if(d.log.i(v,"handleResp-newDv",f.default.buffer2Arr(a.buffer)),a.byteLength<16)this.respBufIndex=0;else{var s=u.default.crc32buf(a.buffer.slice(0,a.byteLength-8)),c=a.getInt32(a.byteLength-8);if(s===c){var l=a.getInt8(1);a.getInt8(2),a.getInt8(3);this.respBufIndex=0;var _=a.getInt16(5),h=a.getInt8(7),g=a.getInt8(4);if(1===l){var p=this.buildCallkey(_,h);t({isPost:!0,key:p,buffer:a.buffer,deviceType:_,msgType:h,frameType:l})}else if(3===l){var E=this.buildCallkey(_,h,g),B=this.callStatusMap.get(E);B&&(B.resp=!0,B.respTime=(new Date).getTime(),this.callStatusMap.put(E,B)),t({isPost:!1,key:E,buffer:a.buffer,deviceType:_,msgType:h,frameType:l})}else d.log.i(v,"handleResp-unexpected-frameType",l,f.default.buffer2Arr(a.buffer))}else this.respBufIndex=0}}}},this.buildHeader=function(e,t,n,r,o){o.setInt8(0,0),o.setInt8(1,2),o.setInt8(2,t),o.setInt8(3,n),o.setInt8(4,e),o.setInt16(5,r)},this.buildEnder=function(e,t){var n=u.default.crc32buf(e.buffer.slice(0,8+t));e.position=8+t,e.set4x(n);for(var r=0;r<this.BUF_SEPARATOR_ARR.length;r++)e.set1x(this.BUF_SEPARATOR_ARR[r])},this.buildCallkey=function(e,t,n){return void 0===n?e+"_"+t:e+"_"+t+"_"+n},this.isEndMsg=function(e,t){return!(t<3)&&(e.getUint8(t)===this.BUF_SEPARATOR_ARR[3]&&e.getUint8(t-1)===this.BUF_SEPARATOR_ARR[2]&&e.getUint8(t-2)===this.BUF_SEPARATOR_ARR[1]&&e.getUint8(t-3)===this.BUF_SEPARATOR_ARR[0])}}function s(){this.resp=!0,this.key=!0,this.callStatusMap=new _.Map,this.respDv=new DataView(new ArrayBuffer(4096)),this.respBufIndex=0,this.MSG_SUB_ARR=[18,239],this.MSG_LEN=0,this.MSG_START=0,this.POST_MSGTYPE_TEM=-1,this.buildMsg=function(e){var t=r(),n=t,o=e.content||new ArrayBuffer(0),i=new DataView(new ArrayBuffer(15+o.byteLength));this.buildHeader(n,t,e.msgType,e.frameType,i);for(var a=this.buildCallkey(e.deviceType,e.msgType,t),s=new DataView(o),c=0;c<o.byteLength;c++)i.set1x(s.get1x());return this.buildEnder(i,o.byteLength),d.log.i(v,"buildMsg",f.default.buffer2Arr(i.buffer)),{key:a,buffer:i.buffer}},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,o=0,i=setInterval(function(){o++;var a=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(a=!0,n.callStatusMap.remove(e.key)):a=!0,(a||o>=r)&&(clearInterval(i),t(a,o))},5)},this.handleResp=function(e,t,n){try{if(d.log.i(v,"handleResp-start",f.default.buffer2Arr(e)),!e||e.byteLength<=0)return;for(var r=e.byteLength,o=new DataView(e),i=0;i<r;i++)if(this.respDv.setInt8(this.respBufIndex,o.getInt8(i)),this.isSubMsg(this.respDv,this.respBufIndex)&&(o.byteLength>=i+1?this.MSG_LEN=o.getUint16(i+1):this.respBufIndex=0,this.MSG_START=this.respBufIndex-1),this.respBufIndex-this.MSG_START+1===this.MSG_LEN){var a=new DataView(this.respDv.buffer.slice(this.MSG_START,this.respBufIndex+1));this.respBufIndex=0,this.MSG_LEN=0,this.MSG_START=0,this.handleRespData(a,t,n)}else this.respBufIndex++}catch(e){d.log.e(v,"handleResp",e)}},this.buildHeader=function(e,t,n,r,o){o.set1x(18),o.set1x(239),o.set2x(o.byteLength),o.set1x(0),r===h.FRAME_TYPE.POST?o.set1x(h.FRAME_TYPE.POST):o.set1x(h.FRAME_TYPE.Request),o.set1x(e);var i=Object(l.crc8buf)(o.buffer.slice(0,7));o.set1x(i),o.set1x(n),o.set2x(t)},this.buildCallkey=function(e,t,n){return e+"_"+n},this.buildEnder=function(e,t){var n=u.default.crc32buf(e.buffer.slice(0,11+t));e.position=11+t,e.set4x(n)},this.isSubMsg=function(e,t){return!(t<1)&&(e.getUint8(t)===this.MSG_SUB_ARR[1]&&e.getUint8(t-1)===this.MSG_SUB_ARR[0])},this.handleRespData=function(e,t,n){d.log.i(v,"handleRespData",f.default.buffer2Arr(e.buffer));try{if(!e||e.byteLength<=9)return;var r=e.getInt8(5),o=e.getInt8(8),i=e.getInt16(9);if(0===r&&(o=this.POST_MSGTYPE_TEM,i=e.getInt8(6)),1===r){t({isPost:!0,key:this.buildCallkey(n,o),buffer:e.buffer,deviceType:n,msgType:o,frameType:r})}else if(3===r||0===r){var a=this.buildCallkey(n,o,i),s=this.callStatusMap.get(a);s&&(s.resp=!0,s.respTime=(new Date).getTime(),this.callStatusMap.put(a,s)),t({isPost:!1,key:a,buffer:e.buffer,deviceType:n,msgType:o,frameType:r})}else d.log.i(v,"handleRespData","unexpected-frameType:",r)}catch(e){d.log.e(v,"handleRespData",e)}}}function c(){this.resp=!0,this.callStatusMap=new _.Map,this.p=new p.a,this.buildMsg=function(e){var t=new g.a;t.frameType=e.frameType,t.deviceType=e.deviceType,t.messageType=e.msgType,t.content=e.content,t.subVersion=e.subVersion,t.frameSequence=r(2),t.channelCode=this.hashCode(e.networkDeviceId);var n=t.data();return{key:f.default.buildKey(t.deviceType,t.messageType,t.frameSequence),buffer:n}},this.hashCode=function(e){e=e||"";for(var t=0,n=e.length,r=0;r<n;r++)(t=31*t+e.charCodeAt(r))>2147483647&&(t%=2147483648);return t},this.nextMsg=function(e,t){var n=this;this.callStatusMap.put(e.key,{resp:!1,time:(new Date).getTime()});var r=(2*e.bufLen+500)/5,o=0,i=setInterval(function(){o++;var a=!1,s=n.callStatusMap.get(e.key);s?s.resp&&(a=!0,n.callStatusMap.remove(e.key)):a=!0,(a||o>=r)&&(clearInterval(i),t(a,o))},5)},this.handleResp=function(e,t,n){try{var r=this.p.appendData(e);if(r&&r.length>0)for(var o=0;o<r.length;o++){var i=f.default.buildKey(n,r[o].messageType,r[o].frameSequence);if(r[o].frameType===E.a.FrameType.POST)t({isPost:!0,key:i,buffer:r[o].content,deviceType:n,frameType:r[o].frameType});else if(r[o].frameType===E.a.FrameType.ACK||r[o].frameType===E.a.FrameType.Response){var a=this.callStatusMap.get(i);a&&(a.resp=!0,a.respTime=(new Date).getTime(),this.callStatusMap.put(i,a)),t({isPost:!1,key:i,buffer:r[o].content,deviceType:n,frameType:r[o].frameType})}}}catch(e){d.log.e(v,"handleRespData",e)}},this.buildCallkey=function(e,t,n){return e+"_"+n},this.handleRespData=function(e,t,n){d.log.i(v,"handleRespData",f.default.buffer2Arr(e.buffer));try{if(!e||e.byteLength<=9)return;var r=e.getInt8(5),o=e.getInt8(8),i=e.getInt16(9);if(0===r&&(o=this.POST_MSGTYPE_TEM,i=e.getInt8(6)),1===r){t({isPost:!0,key:this.buildCallkey(n,o),buffer:e.buffer,deviceType:n,msgType:o,frameType:r})}else if(3===r||0===r){var a=this.buildCallkey(n,o,i),s=this.callStatusMap.get(a);s&&(s.resp=!0,s.respTime=(new Date).getTime(),this.callStatusMap.put(a,s)),t({isPost:!1,key:a,buffer:e.buffer,deviceType:n,msgType:o,frameType:r})}else d.log.i(v,"handleRespData","unexpected-frameType:",r)}catch(e){d.log.e(v,"handleRespData",e)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.MedicaProtocol1=a,t.MedicaProtocol2=s,t.MedicaProtocol3=c;var u=n(6),l=n(11),f=n(1),_=n(3),d=n(0),h=n(2),g=n(13),p=n(26),E=n(9),v="bleProtocol",B=0;t.default={getSNFromAdvertisData:i}},function(e,t,n){"use strict";function r(e){var t=0,n=0,r=0;t^=-1;for(var i=new Int8Array(e),a=0,s=i.byteLength;a<s;a++)n=255&(t^i[a]),r="0x"+o.substr(9*n,8),t=t>>>8^r;return-1^t}Object.defineProperty(t,"__esModule",{value:!0}),t.crc32buf=r;var o="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";t.default={crc32buf:r}},function(e,t,n){"use strict";function r(){this.dataStore=[],this.enqueue=function(e){this.dataStore.push(e)},this.dequeue=function(){return this.dataStore.shift()},this.front=function(){return this.dataStore[0]},this.back=function(){return this.dataStore[this.dataStore.length-1]},this.toString=function(){for(var e="",t=0;t<this.dataStore.length;++t)e+=this.dataStore[t]+"&nbsp;";return e},this.empty=function(){return 0==this.dataStore.length},this.count=function(){return this.dataStore.length}}Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=r,t.default={Queue:r}},function(module,__webpack_exports__,__webpack_require__){"use strict";function MedicaBle(config){this.conf=config||MedicaBle.getBleDefaultConfig(),this.DEVICE_CONNECTION_STATE=!1,this.waitSendQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingFlag=!1,this.invoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!0),this.sendInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!1),this.deviceType=void 0,this.deviceId=void 0,this.setMtuEnable=!1,this.mtu=20,this.maxMtu=503,this.defaultMtu=20,this.setConf=function(e){this.conf=e,this.baseBle=e.nativeBle,this.setMtuEnable=void 0!==e.connection.setMtu&&e.connection.setMtu},this.initBle=function(e,t,n){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-start",arguments),e=e||this.baseBle||Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)(),this.updateBaseBLE(e,t,n)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"initBle",arguments),MedicaBle.initFlag=!1,n&&n()}},this.openBluetoothAdapter=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-start"),BLE_RET.platform.android===this.baseBle.getPlatform()&&this.baseBle.openBluetoothAdapter(function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-callback")}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"openBluetoothAdapter-end")},this.onBluetoothAdapterStateChange=function(e,t){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothAdapterStateChange-start"),t&&(listenerInvoker.clear(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED),MedicaBle.registerBluetoothListeners(this.baseBle));var n=listenerInvoker.init(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,{ignoreTimeout:!0,handler:e});return __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothAdapterStateChange-end",n),n}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBluetoothAdapterStateChange",e)}},this.removeBluetoothAdapterStateListener=function(e){listenerInvoker.clearSingle(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,e),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"removeBluetoothAdapterStateListener-end",e)},this.onBLEConnectionStateChange=function(e,t){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-start",e);var n=listenerInvoker.init(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,e),{ignoreTimeout:!0,handler:t});return __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-end"),n}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBLEConnectionStateChange",e)}},this.removeConnectionStateListener=function(e,t){listenerInvoker.clearSingle(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,e),t),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"removeConnectionStateListener-end",t)},this.onBluetoothDeviceFound=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound-start"),this.invoker.clear(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY),this.invoker.init(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY,{ignoreTimeout:!0,handler:function(r){var o=r;if("string"==typeof r&&(o=JSON.parse(r)),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"discoveryCall-res",o),o)for(var i=0;i<o.length;i++){var a=parseDeviceInfo(o[i]);if(t&&"function"==typeof t){var s=t(a);if(s){n.stopBluetoothDevicesDiscovery();break}}if(e){var c=e(a);if(c){n.stopBluetoothDevicesDiscovery(),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound","stop-ret",c);break}}}}}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBluetoothDeviceFound-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"onBluetoothDeviceFound",e)}},this.getBluetoothAdapterState=function(e){this.baseBle.getBluetoothAdapterState(function(t){MedicaBle.prototype.bleStatus=t,MedicaBle.prototype.bleEnable=t===BLE_RET.bleStatus.available,e&&e(t)})};var stopBleDiscoveryTimeout=null;this.startBluetoothDevicesDiscovery=function(e,t,n,r){this.stopBluetoothDevicesDiscovery();var o=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"startBluetoothDevicesDiscovery-start"),o.baseBle.startBluetoothDevicesDiscovery(e||this.conf.uuids.advertisServiceUUIDs,t,n||this.conf.discovery.interval),stopBleDiscoveryTimeout=setTimeout(function(){o.stopBluetoothDevicesDiscovery()},r||this.conf.discovery.timeout),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"startBluetoothDevicesDiscovery-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"startBluetoothDevicesDiscovery",e)}},this.scanBleDevices=function(e,t,n){var r=this;this.closeAllConnection(),this.baseBle.onBluetoothDeviceFound(function(e){r.invoker.invoke(ON_BLE_EVENT_NAME.DEVICE_DISCOVERY,e)}),r.onBluetoothDeviceFound(n),setTimeout(function(){r.startBluetoothDevicesDiscovery(void 0,t,200,e)},100)},this.stopBluetoothDevicesDiscovery=function(){return stopBleDiscoveryTimeout&&(clearTimeout(stopBleDiscoveryTimeout),stopBleDiscoveryTimeout=null),this.baseBle.stopBluetoothDevicesDiscovery()},this.createBond=function(e,t,n,r){this.baseBle.createBond(e,t,n,r)},this.sendDataByTraditionalBT=function(e,t,n,r,o){this.baseBle.sendDataByTraditionalBT(e,t,n,r,o)},this.filterInit=function(e){this.baseBle.filterInit(e)},this.filterEnd=function(e){this.baseBle.filterEnd(e)},this.filterParse=function(e,t,n){this.baseBle.filterParse(e,t,n)},this.createBLEConnection=function(deviceId,timeout,callback){var that=this;try{var key="__createBLEConnectionCallback"+deviceId;this.invoker.init(key,{timeout:timeout,handler:callback}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-start",deviceId,timeout);var isTimeout=!1;that.deviceId=deviceId,that.baseBle.onBLEConnectionStateChange(function(retObj){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-callback",retObj);var _deviceId=retObj.deviceId,_connected=retObj.connected;MedicaBle.notifyConnectionState(that.deviceId,_deviceId,_connected),_deviceId===deviceId&&(that.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,_connected,deviceId),that.DEVICE_CONNECTION_STATE=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-invoke-end",_connected,deviceId),_connected===BLE_RET.Boolean.True?(connPool.put(_deviceId,that),that.baseBle.discoverBLEServerAndCharacteristic(deviceId,that.conf.uuids.writeServiceUUID,that.conf.uuids.writeCharacteristUUID,function(){that.baseBle.discoverBLEServerAndCharacteristic(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,function(){that.baseBle.notifyBLECharacteristicValueChange(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,BLE_RET.Boolean.True,function(){that.baseBle.onBLECharacteristicValueChange(function(json){if(deviceId===json.deviceId){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLECharacteristicValueChange-arr",_typeof(json.value),json.value instanceof Array,json.value);var _arr=[];"string"==typeof json.value?_arr=eval(json.value):json.value instanceof Array&&(_arr=json.value),that.handleCharacteristicValue(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(_arr))}}),that.setMtuEnable?that.setMtu(function(){setTimeout(function(){that.invoker.invoke(key,BLE_RET.connection.connected,_deviceId)},20)}):setTimeout(function(){that.invoker.invoke(key,BLE_RET.connection.connected,_deviceId)},100)})})})):(that.invoker.invoke(key,BLE_RET.connection.disconnected,_deviceId),that.DEVICE_CONNECTION_STATE=!1,connPool.remove(_deviceId)))}),setTimeout(function(){that.baseBle.createBLEConnection(deviceId,timeout-180)},50),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"createBLEConnection",e)}},this.registerConnectionListener=function(deviceId){var that=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerConnectionListener-start",deviceId),that.deviceId=deviceId,MedicaBle.registerBluetoothListeners(that.baseBle),that.baseBle.onBLEConnectionStateChange(function(retObj){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-callback",retObj);var _deviceId=retObj.deviceId,_connected=retObj.connected;MedicaBle.notifyConnectionState(that.deviceId,_deviceId,_connected),_deviceId===deviceId&&(that.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,_connected,deviceId),that.DEVICE_CONNECTION_STATE=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLEConnectionStateChange-invoke-end",_connected,deviceId),_connected===BLE_RET.Boolean.True?(connPool.put(_deviceId,that),that.baseBle.notifyBLECharacteristicValueChange(deviceId,that.conf.uuids.notifyServiceUUID,that.conf.uuids.notifyCharacteristUUID,BLE_RET.Boolean.True,function(){that.baseBle.onBLECharacteristicValueChange(function(json){if(deviceId===json.deviceId){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"onBLECharacteristicValueChange-arr",_typeof(json.value),json.value instanceof Array,json.value);var _arr=[];"string"==typeof json.value?_arr=eval(json.value):json.value instanceof Array&&(_arr=json.value),that.handleCharacteristicValue(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(_arr))}})})):(that.DEVICE_CONNECTION_STATE=!1,connPool.remove(_deviceId)))}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerConnectionListener-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"registerConnectionListener",e)}},this.connectDeviceOnce=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDeviceOnce-start",e,t);var r=1;t&&(r=t+1);var o="__connectDevice"+e;if(n.DEVICE_CONNECTION_STATE)return n.invoker.invoke(o,BLE_RET.connection.connected,e),null;n.createBLEConnection(e,n.conf.connection.oneTryTimeout||1e4,function(t){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"createBLEConnection-callback",t),t===BLE_RET.connection.connected?n.invoker.invoke(o,BLE_RET.connection.connected,e):n.invoker.getData(o)&&setTimeout(function(){n.connectDeviceOnce(e,r)},500)}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDeviceOnce-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"connectDeviceOnce",e)}},this.connectDevice=function(e,t,n,r){var o=this;try{if(r&&""!==r&&0!==r&&(this.deviceType=r),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-start",e,t),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-conf",this.deviceType,this.conf),e===this.deviceId&&this.DEVICE_CONNECTION_STATE)return n(BLE_RET.connection.connected,e),null;this.closeAllConnection(),this.setCurrentConnectionInstance(this);var i={deviceId:e,timeout:t||this.conf.connection.timeout,handler:n};o.deviceId=e;var a="__connectDevice"+e,s=o.invoker.getData(a);if(o.invoker.init(a,i),s)return null;o.connectDeviceOnce(e,0),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"connectDevice-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"connectDevice",e)}},this.sendOnePacket=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket-start",__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buffer2Arr(e),t);var r=1;t&&(r=t+1),n.baseBle.writeBLECharacteristicValue(this.deviceId,this.conf.uuids.writeServiceUUID,this.conf.uuids.writeCharacteristUUID,this.conf.write.writeResponse,__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buffer2Arr(e),function(t){n.baseBle.getPlatform()===BLE_RET.platform.android&&t!==BLE_RET.status.suc&&r<=3&&setTimeout(function(){n.sendOnePacket(e,r)},100)}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendOnePacket",e)}},this.handleCharacteristicValue=function(e){var t=this;try{this.conf.protocol.handleResp(e,function(e){t.conf.protocol.resp&&(e.isPost?t.handlePostMsg(e):(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handleCharacteristicValue-invoke",e.key,BLE_RET.status.suc,e.buffer,e),t.sendInvoker.invoke(e.key,BLE_RET.status.suc,e.buffer,e)))},t.deviceType),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handleCharacteristicValue-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"handleCharacteristicValue",e)}},this.handlePostMsg=function(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"handlePostMsg-data",e),this.invoker.invoke(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK,e)},this.sendPacket=function(e){try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-start",e),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-conf",this.conf,this.deviceType,e),e.deviceType||(e.deviceType=this.deviceType);var t=this.conf.protocol.buildMsg(e);t.key&&this.sendInvoker.init(t.key,{handler:e.handler,timeout:e.timeout||this.conf.write.timeout}),e.mtu&&e.mtu>0&&(this.mtu=e.mtu),t.bufLen=t.buffer.byteLength,t.sentIndex=-1,t.tryTimes=0,t.bufArr=t.buffer.split(this.mtu),this.waitSendQueue.enqueue(t),this.sendAllQueue(!1),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendPacket-end",t)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendPacket",e)}},this.sendAllQueue=function(e){var t=this;try{if(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-start",arguments),!t.sendingFlag||e){if(t.sendingFlag=!0,t.waitSendQueue.count()<=0&&t.sendingQueue.count()<=0)return void(t.sendingFlag=!1);var n=t.waitSendQueue.front();t.sendingQueue.enqueue(n),t.waitSendQueue.dequeue(),t.sendOneMsg()}else __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-skin",t.sendingFlag,e);__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendAllQueue-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendAllQueue",e)}},this.sendOneMsg=function(){var e=this;try{if(e.sendingQueue.count()<=0)return void __WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","count=0");var t=e.sendingQueue.front();__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","start",t);var n=t.bufArr;if(t.waitResp);else{var r=void 0;if(e.baseBle.getPlatform()===BLE_RET.platform.ios)r=3;else{var o=n[0].byteLength;r=.5*o<=10?10:.5*o}__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","_timeout",r);var i=0,a=setInterval(function(){var r=n.length;__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOnePacket",i),e.sendOnePacket(n[i++],0),i===r&&(e.handleSentMsg(t),clearInterval(a))},r)}__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"sendOneMsg","end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"sendOneMsg",e)}},this.handleSentMsg=function(e){var t=this;this.conf.protocol.nextMsg(e,function(e){t.sendingQueue.dequeue(),t.sendAllQueue(!0)})},this.requestMtuOne=function(e,t){var n=this;try{__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"requestMtuOne-start",e);var r=0;void 0!==e&&null!==e&&(r=e+1);var o=!1;n.baseBle.setMTUSize(this.maxMtu,function(e){e.status===BLE_RET.Boolean.True&&e.mtu&&e.mtu>0?(n.mtu=e.mtu,t(BLE_RET.status.suc,e.mtu),o=!0,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"setMTUSize-callback",e)):n.requestMtuOne(r,t)}),setTimeout(function(){o||(r>=4?t(BLE_RET.status.fail,n.defaultMtu):n.requestMtuOne(r,t))},1e3)}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"requestMtuOne",e)}},this.setMtu=function(e){this.requestMtuOne(0,e)},this.registerPostMsgHanlder=function(e){this.invoker.clear(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK),this.invoker.init(ON_BLE_EVENT_NAME.POST_MSG_CALLBACK,{ignoreTimeout:!0,handler:e})},this.closeConnection=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeConnection-start",this.deviceId,this.DEVICE_CONNECTION_STATE),this.deviceId&&(this.baseBle.closeBLEConnection(this.deviceId),this.invoker.invoke(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,BLE_RET.Boolean.False,this.deviceId)),this.sendInvoker.invokeAll(BLE_RET.status.timeout),this.DEVICE_CONNECTION_STATE=!1,this.waitSendQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingQueue=new __WEBPACK_IMPORTED_MODULE_2__queue__.default.Queue,this.sendingFlag=!1,this.sendInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!1),this.mtu=this.defaultMtu,__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeConnection-end")},this.getConnectionState=function(){return this.DEVICE_CONNECTION_STATE},this.closeBluetoothAdapter=function(){this.baseBle.closeBluetoothAdapter()},this.getConnectionStateAsynchr=function(e,t){var n=this;this.deviceId=e,this.baseBle.getConnectedBluetoothDevices(function(e){for(var r=!1,o=0;o<e.length;o++)if(e[o].deviceId===n.deviceId){r=!0;break}n.DEVICE_CONNECTION_STATE=r,t(r)})}}function parseDeviceInfo(e){return e=JSON.parse(JSON.stringify(e)),e.advertisData&&e.advertisData instanceof Array&&e.advertisData.length>0?e.advertisData=__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(e.advertisData):e.advertisData=new ArrayBuffer(0),e.serviceData&&e.serviceData instanceof Array&&e.serviceData.length>0?e.serviceData=__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.arr2Buffer(e.serviceData):e.serviceData=new ArrayBuffer(0),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"parse-device-info",e),e}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),__webpack_require__.d(__webpack_exports__,"BLE_RET",function(){return BLE_RET}),__webpack_require__.d(__webpack_exports__,"connPool",function(){return connPool}),__webpack_require__.d(__webpack_exports__,"currentConnectionInstance",function(){return currentConnectionInstance}),__webpack_exports__.MedicaBle=MedicaBle;var __WEBPACK_IMPORTED_MODULE_0__InvokerManager__=__webpack_require__(12),__WEBPACK_IMPORTED_MODULE_1__bufUtil__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_2__queue__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_3__medica_ble_protocol__=__webpack_require__(5),__WEBPACK_IMPORTED_MODULE_4__log_config__=__webpack_require__(0),__WEBPACK_IMPORTED_MODULE_5__Constants__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_6__map__=__webpack_require__(3),__WEBPACK_IMPORTED_MODULE_7__init_ble_native__=__webpack_require__(15),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},logTip="bleWrap",DEFAULT_BLE_CONFIG={nativeBle:void 0,discovery:{allowDuplicatesKey:!1,interval:100,timeout:3e4},connection:{timeout:3e4,oneTryTimeout:1e4,setMtu:!1},write:{timeout:3e3,writeResponse:!1},uuids:{writeServiceUUID:"0000ffe5-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyServiceUUID:"0000ffe0-0000-1000-8000-00805f9b34fb".toUpperCase(),writeCharacteristUUID:"0000ffe9-0000-1000-8000-00805f9b34fb".toUpperCase(),notifyCharacteristUUID:"0000ffe4-0000-1000-8000-00805f9b34fb".toUpperCase(),advertisServiceUUIDs:["0000fff0-0000-1000-8000-00805f9b34fb".toUpperCase(),"0000ffb0-0000-1000-8000-00805f9b34fb".toUpperCase()]},protocol:void 0},ON_BLE_EVENT_NAME=__WEBPACK_IMPORTED_MODULE_5__Constants__.default.ON_BLE_EVENT_NAME,BLE_RET=__WEBPACK_IMPORTED_MODULE_5__Constants__.default.BLE_RET,connPool=new __WEBPACK_IMPORTED_MODULE_6__map__.Map,currentConnectionInstance=void 0;MedicaBle.prototype.baseBle=null,MedicaBle.prototype.updateBaseBLE=function(e,t,n){this.baseBle!==e?(MedicaBle.prototype.baseBle=e,MedicaBle.initBle(e,!0,n)):t?MedicaBle.initBle(e,!0,n):n&&n(MedicaBle.prototype.bleStatus)},MedicaBle.prototype.getConnectedDeviceId=function(){for(var e=connPool.keySet(),t=0;t<e.length;t++){var n=connPool.get(e[t]);if(n&&n.DEVICE_CONNECTION_STATE)return n.deviceId}},MedicaBle.prototype.closeAllConnection=function(){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeAllConnection-start");for(var e=connPool.keySet(),t=0;t<e.length;t++){var n=e[t];connPool.get(n).closeConnection(),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"closeAllConnection",n)}},MedicaBle.prototype.getCurrentConnectionInstance=function(){return currentConnectionInstance},MedicaBle.prototype.setCurrentConnectionInstance=function(e){currentConnectionInstance=e||this},MedicaBle.getBleDefaultConfig=function(e){var t=JSON.parse(JSON.stringify(DEFAULT_BLE_CONFIG));return t.protocol=new __WEBPACK_IMPORTED_MODULE_3__medica_ble_protocol__.MedicaProtocol1,t.nativeBle=Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)(),t},MedicaBle.defaultBleNative=Object(__WEBPACK_IMPORTED_MODULE_7__init_ble_native__.getBleNative)();var listenerInvoker=new __WEBPACK_IMPORTED_MODULE_0__InvokerManager__.InvokerManager(3e3,!0);MedicaBle.registerBluetoothListeners=function(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"registerBluetoothListeners-start",e),e.onBluetoothAdapterStateChange(function(e){var t=e===BLE_RET.Boolean.True;MedicaBle.prototype.bleStatus=t?0:1,MedicaBle.prototype.bleEnable=t,listenerInvoker.invoke(ON_BLE_EVENT_NAME.ADAPTER_OPEN_CHANGED,t)})},MedicaBle.notifyConnectionState=function(e,t,n){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"notifyConnectionState",e,t,n,__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,t));var r=n===BLE_RET.Boolean.True;if(listenerInvoker.invoke(__WEBPACK_IMPORTED_MODULE_1__bufUtil__.default.buildKey(ON_BLE_EVENT_NAME.CONNECTION_CHANGED,t),r),e&&t&&e!==t){var o=connPool.get(t);if(o){o.DEVICE_CONNECTION_STATE=r;var i="__createBLEConnectionCallback"+t;o.invoker.invoke(i,r,t),r||connPool.remove(t)}}},MedicaBle.initFlag=!1,MedicaBle.initBle=function(e,t,n){try{if(__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-start"),!t&&MedicaBle.initFlag)return void e.getBluetoothAdapterState(function(e){MedicaBle.prototype.bleStatus=e,MedicaBle.prototype.bleEnable=e===BLE_RET.bleStatus.available,n&&n(e)});MedicaBle.initFlag=!0,MedicaBle.registerBluetoothListeners(e),e.initializeBluetoothAdapter(function(){e.getBluetoothAdapterState(function(e){MedicaBle.prototype.bleStatus=e,MedicaBle.prototype.bleEnable=e===BLE_RET.bleStatus.available,n&&n(e)})}),__WEBPACK_IMPORTED_MODULE_4__log_config__.log.i(logTip,"initBle-end")}catch(e){__WEBPACK_IMPORTED_MODULE_4__log_config__.log.e(logTip,"initBle",e)}}},function(e,t,n){"use strict";var r={RET:{Succeed:0,Network_Disable:1,Socket_Disconnect:2,Failed:3,Timeout:255},NetWorkStatus:{None:0,WWAN:1,Wifi:2},socketState:{connected:0,disconnect:1},FrameType:{ACK:0,POST:1,Request:2,Response:3},ProResCode:{OK:0,SERVER_ERROR:1,LOGIN_OUT:2,NOT_BOUND:3,SENSOR_NOT_BOUND:4,SENSOR_IS_BOUND:5,NOT_ONLINE:6,APP_ONT_ONLINE:7,SERSOR_NOT_ONLINE:8,NOT_FOUND:9,NO_ACCESS:10,OPERATION_FAIL:11,SENSOR_NOT_FOUND:12,SENSOR_CONN_FAIL:13,BLE_BUSY:14,UPDATING:15,ERROR:255},timeout:1e4,separator:[36,95,64,45],specialId:5e4};t.a=r},function(e,t,n){"use strict";(function(e){function r(e){try{return prompt(e)}catch(e){}}function o(e){var t=JSON.stringify(e);return l.Base64.encode(t)}function i(e){try{var t=l.Base64.decode(e);return JSON.parse(t)}catch(e){}}function a(e,t){try{var n,i;if(navigator.useWkWebView){var a={func:e};void 0!=t&&(a.value=t),i=o(a),n=r(i)}else void 0!=t?(i=o(t),n=g[e](i)):n=g[e]();return n&&(n="string"==typeof n?JSON.parse(l.Base64.decode(n)):n),f.log.i(d,"callNative",e,t,n),n}catch(e){f.log.i(d,"callNative",e)}}function s(e,t,n){try{var r="__"+e+"Callback";return window[r]=function(){if(n){var t=[];if(arguments.length){for(var r=0;r<arguments.length;r++){var o=arguments[r];t.push(o?i(o):"")}f.log.i(d,"nativeCallback",e,t),n.apply(this,t)}else f.log.i(d,"nativeCallback",e,t),n()}},t?t.callback=r:t={callback:r},a(e,t)}catch(e){f.log.e(d,"callNative",e)}}function c(){return f.log.i(d,"getSystemInfoSync",(new Date).valueOf()),p=a("getSystemInfoSync"),navigator.devicePlatform=p.platform,f.log.i(d,"getSystemInfoSync",(new Date).valueOf()),p}function u(){return void 0==p?c().platform:p}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return u});var l=n(27),f=(n.n(l),n(0)),_=n(28),d="base-native",h="undefined"!=typeof window?window:e,g=void 0;try{g=window.medica}catch(e){}try{navigator.useWkWebView="2"===_.a.urlParse().params.useWkWebView}catch(e){}"undefined"==typeof navigator&&(h.navigator={useWkWebView:!1});var p=void 0}).call(t,n(17))},function(e,t,n){"use strict";function r(e){var t=0;t=255&~t;for(var n=new Int8Array(e),r=0;r<n.byteLength;r++){n[r];t=255&o[255&(t^n[r])]}return 255&~t}Object.defineProperty(t,"__esModule",{value:!0}),t.crc8buf=r;var o=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243]},function(e,t,n){"use strict";function r(e,t){this.timeoutCode=9009,this.cache=new o.default.Map,this.defaultTimeout=e||5e3,this.enableMulti=t||!1,this.init=function(e,t){var n=t,r=void 0;n.createTime=(new Date).getTime(),i.log.i("invoker.init.createTime:",e,this.enableMulti,n.createTime);var s=this.cache.get(e);s||(s=new o.default.Map);var c=e+"_"+Object(a.randomNum)(1e6,9999999);return s.put(c,n),this.cache.put(e,s),r=c,i.log.i("InvokerManager","init",r),r},this.invoke=function(){try{for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=this.cache.get(r);if(i.log.i("InvokerManager.invoke.start:",t[0],this.cache,this.cache.containsKey(r)),o&&o.size()>0){var a=o.keySet();for(var c in a){var u=o.get(a[c]);if(u&&u.handler)try{u.handler.apply(null,t.length>1?t.slice(1):[]),i.log.i(s,"invoke-end:",r,a[c],u.createTime)}catch(e){i.log.e(s,"_data.handler.invoker.invoke:",e)}u&&u.ignoreTimeout||(o.remove(a[c]),this.cache.put(r,o))}}else i.log.i("InvokerManager","not find the handler by ",r),this.cache.remove(r)}catch(e){i.log.e("InvokerManager","invoker.ERROR:",e)}},this.invokeSingle=function(){try{for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t[1],a=this.cache.get(r);if(a&&a.size()>0){for(var c=a.keySet(),u=0;u<c.length;u++)if(c[u]===o){var l=a.get(c[u]);if(l&&l.handler)try{l.handler.apply(null,t.length>2?t.slice(2):[]),i.log.i(s,"invokeSingle-end:",r,c[u],l.createTime)}catch(e){i.log.e(s,"_data.handler.invoker.invoke:",e)}if(l&&l.ignoreTimeout)continue;a.remove(c[u]),this.cache.put(r,a)}}else this.cache.remove(r)}catch(e){i.log.e("InvokerManager","invoker.ERROR:",e)}},this.invokeAll=function(){for(var e=this.cache.keySet(),t=[],n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var i=0;i<r.length;i++)t.push(r[i]);for(var a=0;a<e.length;a++){var s=e[a];t.unshift(s),this.invoke(t)}},this.getData=function(e){var t=this.getDatas(e);if(t&&t.size()>0)return t.values()[0]},this.getDatas=function(e){return this.cache.get(e)},this.existData=function(e){return!this.cache.get(e)},this.clear=function(e){e?this.cache.remove(e):this.cache=new o.default.Map},this.clearSingle=function(e,t){i.log.i(s,"clearSingle",e);var n=this.cache.get(e);n&&(n.remove(t),i.log.i(s,"clearSingle-end",t))},this.size=function(e){if(e){var t=this.cache.get(e);return t?t.size():0}return this.cache.size()},this.invokeTimeout=function(){var e=this;setInterval(function(){for(var t=e.cache.keySet(),n=0;n<t.length;n++){var r=t[n],o=e.cache.get(r);if(o&&o.size()>0)for(var a=o.keySet(),c=0;c<a.length;c++){var u=a[c],l=o.get(u);if((!l||!l.ignoreTimeout)&&(l&&l.handler)){var f=l.timeout?l.timeout:e.defaultTimeout,_=l.createTime;if((new Date).getTime()-_>=f){try{var d=l.tryTimes?l.tryTimes+1:1;l.tryTimes=d,i.log.i(s,"timeout-invoke",u,l),l.handler(e.timeoutCode,l)}catch(e){i.log.e(s,"timeout-invoke-err",e)}o.remove(u),e.cache.put(r,o)}}}else e.cache.remove(r)}},500)},this.invokeTimeout()}Object.defineProperty(t,"__esModule",{value:!0}),t.InvokerManager=r;var o=n(3),i=n(0),a=n(4),s="InvokerManager"},function(e,t,n){"use strict";function r(){var e=this;this.version=1,this.source=1,this.channelCode=0,this.frameType=0,this.frameNumber=1,this.frameIndex=0,this.frameSequence=0,this.subVersion=1,this.specialId=i.a.specialId,this.deviceType=0,this.messageType=0,this.content=new ArrayBuffer(0),this.separator=i.a.separator,this._payload=new ArrayBuffer(0),this.data=function(){return u(e)},this.key=function(){return"ProtocolNox:"+e.frameSequence}}n.d(t,"a",function(){return r}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return f});var o=n(14),i=n(9),a=n(6),s=function(e){var t=6+e.content.byteLength;0===e.subVersion&&(t=2+e.content.byteLength);var n=new DataView(new ArrayBuffer(t)),r=0;1===e.subVersion&&(n.setInt16(r,e.specialId),r+=2,n.setInt16(r,e.deviceType),r+=2),n.setInt16(r,e.messageType),r+=2;for(var o=new DataView(e.content),i=0;i<e.content.byteLength;i++)n.setInt8(r,o.getInt8(i)),r+=1;return n.buffer},c=function(e){var t=21+e._payload.byteLength,n=new DataView(new ArrayBuffer(t)),r=0;n.setInt8(r,e.version),r+=1,n.setInt8(r,e.source),r+=1,n.setInt32(r,e.channelCode),r+=4,n.setInt8(r,e.frameType),r+=1,n.setInt16(r,e.frameNumber),r+=2,n.setInt16(r,e.frameIndex),r+=2,n.setInt16(r,e.frameSequence),r+=2;for(var o=new DataView(e._payload),i=0;i<e._payload.byteLength;i++)n.setInt8(r,o.getInt8(i)),r+=1;var s=a.default.crc32buf(n.buffer.slice(0,t-8));n.setInt32(r,s),r+=4;for(var c=0;c<e.separator.length;c++){var u=e.separator[c];n.setInt8(r,u),r+=1}return n.buffer},u=function(e){e._payload=s(e);for(var t=o.a.cutArrayBufferWithSeparatorFromIndex(e._payload,e.separator,2),n=t.length,i=new ArrayBuffer(0),a=0;a<n;a++){var u=t[a],l=new r;l.version=e.version,l.source=e.source,l.channelCode=e.channelCode,l.frameType=e.frameType,l.frameNumber=n,l.frameIndex=a,l.frameSequence=e.frameSequence,l._payload=u,l.separator=e.separator;var f=c(l);i=i.append(f)}return i},l=function(e){var t=e.byteLength;if(!e||t<21)return null;var n=new DataView(e),o=n.getInt32(t-8),s=e.slice(0,t-8);if(o!=a.default.crc32buf(s))return null;var c=new r,u=0;return c.version=n.getInt8(u),u+=1,c.source=n.getInt8(u),u+=1,c.channelCode=n.getInt32(u),u+=4,c.frameType=n.getInt8(u),u+=1,c.frameNumber=n.getInt16(u),u+=2,c.frameIndex=n.getInt16(u),u+=2,c.frameSequence=n.getInt16(u),u+=2,c._payload=e.slice(u,t-8),n.getUint16(13)==i.a.specialId?c.subVersion=1:c.subVersion=0,c},f=function(e){var t=e._payload,n=new DataView(t),r=0;return 1==e.subVersion&&(e.specialId=n.getInt16(r),r+=2,e.deviceType=n.getInt16(r),r+=2),e.messageType=n.getInt16(r),r+=2,e.content=t.slice(r),e}},function(e,t,n){"use strict";function r(e,t){if(0==t.length)return{left:e,bufferAry:[]};var n=i(e,t);if(0==n.length)return{left:e,bufferAry:[]};for(var r=[],o=0,s=0;s<n.length;s++){var c=n[s],u=c.location+c.length-o,l={location:o,length:u},f=a(e,l);r.push(f),o+=u}var _={};if(_.bufferAry=r,o<e.byteLength){var d={location:o,length:e.byteLength-o},h=a(e,d);_.left=h}else _.left=new ArrayBuffer(0);return _}function o(e,t,n){if(0==t.length)return[e];var r=i(e,t);if(0==r.length)return[e];for(var o=[],s=0,c=0;c<r.length;c++){var u=r[c],l=u.location+n-s,f={location:s,length:l},_=a(e,f);o.push(_),s+=l}if(s<e.byteLength){var d={location:s,length:e.byteLength-s},h=a(e,d);o.push(h)}return o}function i(e,t){if(t.length>e.byteLength)return[];for(var n=[],r=u.default.buffer2Arr(e),o=t.length,i=0;i<=r.length-o;){r.slice(i,i+o).isEqualToAnother(t)?(n.push({location:i,length:o}),i+=o):i++}return n}function a(e,t){var n=u.default.buffer2Arr(e),r=t.location,o=t.length;return n=n.slice(r,r+o),u.default.arr2Buffer(n)}function s(e,t){var n=u.default.buffer2Arr(e),r=t.location,o=t.length;return n.length<r+o?e:(n.splice(r,o),u.default.arr2Buffer(n))}function c(e){for(var t=new DataView(e),n=[],r=0;r<e.byteLength;r++)n.push(t.getUint8(r).toString(16));return n}var u=n(1);Array.prototype.isEqualToAnother=function(e){var t=!1;return this.toString()===e.toString()&&(t=!0),t},t.a={cutArrayBufferWithSeparator:r,cutArrayBufferWithSeparatorFromIndex:o,rangeListOfSeparator:i,subArrayBuffer:a,cutOffArrayBuffer:s,bufferToHexAry:c}},function(e,t,n){"use strict";function r(e){s.INIT_CONF.nativeApp=e}function o(e){return e&&r(e),s.INIT_CONF.nativeApp===s._const.nativeApp.weixin?a.default:s.INIT_CONF.nativeApp!==s._const.nativeApp.hilink?i.default:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.setBleNative=r,t.getBleNative=o;var i=n(16),a=n(18),s=n(19)},function(e,t,n){"use strict";function r(e,t,n){var r=O[e],o=n;if(!r)return o;for(var i in r){-1!==r[i].indexOf(t.toLowerCase())&&(o=i)}return o}function o(e){Object(I.b)("initializeBluetoothAdapter",void 0,e)}function i(e){Object(I.b)("openBluetoothAdapter",void 0,e)}function a(e){Object(I.b)("closeBluetoothAdapter",void 0,e)}function s(e){Object(I.b)("onBluetoothAdapterStateChange",void 0,e)}function c(e){var t=Object(I.a)("getBluetoothAdapterState");return e(t),t}function u(e,t,n){if(e&&!(e instanceof Array))throw"services must be an Array";var r={services:e,allowDuplicatesKey:t,interval:n};return Object(I.a)("startBluetoothDevicesDiscovery",r)}function l(e){Object(I.b)("onBluetoothDeviceFound",void 0,e)}function f(){return Object(I.a)("stopBluetoothDevicesDiscovery")}function _(){return Object(I.a)("getBluetoothDevices")}function d(){return Object(I.a)("getConnectedBluetoothDevices")}function h(e){return Object(I.a)("createBLEConnection",{deviceId:e})}function g(e){return Object(I.a)("closeBLEConnection",{deviceId:e})}function p(e){Object(I.b)("onBLEConnectionStateChange",void 0,e)}function E(e,t,n,r){var o={deviceId:e,serviceId:t,characteristicId:n};return Object(I.b)("discoverBLEServerAndCharacteristic",o,function(t){t&&t.data?O[e]=t.data:delete O[e],r&&r.apply(void 0,arguments)})}function v(e,t,n,o,i){var a={deviceId:e,serviceId:r(e,n,t),characteristicId:n,state:o};return Object(I.b)("notifyBLECharacteristicValueChange",a,i)}function B(e,t,n,o,i,a){var s={deviceId:e,serviceId:r(e,n,t),characteristicId:n,response:o,value:i},c=Object(I.a)("writeBLECharacteristicValue",s);return a(c),c}function D(e){return Object(I.b)("onBLECharacteristicValueChange",void 0,e)}function y(){return Object(I.a)("getBluetoothMTU")}function b(e,t,n,r){var o={deviceType:e,btAddress:t,newVerCode:n};Object(I.b)("createBond",o,r)}function A(e,t,n,r,o){var i={fileName:e,btAddress:t,fileUUID:n,data:r};Object(I.b)("sendDataByTraditionalBT",i,o)}function C(e){Object(I.b)("filterInit",void 0,e)}function T(e){Object(I.b)("filterEnd",void 0,e)}function w(e,t,n){var r={original:e,state:t};Object(I.b)("filterParse",r,n)}function M(e,t){var n={size:e};if(/iPhone|iPad/i.test(navigator.userAgent))return void t({status:0,mtu:20});Object(I.b)("setMTUSize",n,t)}function m(e,t){var n={deviceId:e,interval:t};return Object(I.a)("setBluetoothRecieveInterval",n)}Object.defineProperty(t,"__esModule",{value:!0});var I=n(10),O={};t.default={$nativeName:"medica",getSystemInfoSync:I.d,getPlatform:I.c,initializeBluetoothAdapter:o,openBluetoothAdapter:i,closeBluetoothAdapter:a,onBluetoothAdapterStateChange:s,getBluetoothAdapterState:c,startBluetoothDevicesDiscovery:u,onBluetoothDeviceFound:l,stopBluetoothDevicesDiscovery:f,getBluetoothDevices:_,getConnectedBluetoothDevices:d,createBLEConnection:h,closeBLEConnection:g,onBLEConnectionStateChange:p,discoverBLEServerAndCharacteristic:E,notifyBLECharacteristicValueChange:v,writeBLECharacteristicValue:B,onBLECharacteristicValueChange:D,getBluetoothMTU:y,setMTUSize:M,setBluetoothRecieveInterval:m,createBond:b,sendDataByTraditionalBT:A,filterInit:C,filterEnd:T,filterParse:w}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){wx.openBluetoothAdapter({complete:function(t){e()}}),M.log.i(O,"initializeBluetoothAdapter-end")}function o(e){M.log.i(O,"openBluetoothAdapter"),wx.openBluetoothAdapter({success:function(e){M.log.i(O,"openBluetoothAdapter-success",e)},fail:function(e){M.log.i(O,"openBluetoothAdapter-success",e)},complete:function(t){e&&e()}})}function i(e){wx.closeBluetoothAdapter({success:function(t){e&&e(m.default.BLE_RET.Boolean.True)},fail:function(t){e&&e(m.default.BLE_RET.Boolean.False)}}),M.log.i(O,"closeBluetoothAdapter-end")}function a(e){M.log.i(O,"onBluetoothAdapterStateChange-start"),wx.onBluetoothAdapterStateChange(function(t){M.log.i(O,"onBluetoothAdapterStateChange-callback",t);var n=t.available?m.default.BLE_RET.Boolean.True:m.default.BLE_RET.Boolean.False;e(n)})}function s(e){M.log.i(O,"getBluetoothAdapterState-start"),wx.getBluetoothAdapterState({success:function(t){M.log.i(O,"getBluetoothAdapterState-success",t);var n=t.available?m.default.BLE_RET.Boolean.True:m.default.BLE_RET.Boolean.False;e(n)}})}function c(e,t,n){if(M.log.i(O,"startBluetoothDevicesDiscovery-start",arguments),e&&!(e instanceof Array))throw"services must be an Array";wx.startBluetoothDevicesDiscovery({allowDuplicatesKey:t,success:function(e){M.log.i(O,"startBluetoothDevicesDiscovery-success",arguments)},fail:function(e){M.log.i(O,e)}})}function u(e){if(e&&e.length>0){for(var t=0;t<e.length;t++)e[t].advertisData&&e[t].advertisData instanceof ArrayBuffer&&(e[t].advertisData=I.default.buffer2Arr(e[t].advertisData)),e[t].serviceData&&e[t].serviceData instanceof ArrayBuffer&&(e[t].serviceData=I.default.buffer2Arr(e[t].serviceData));return M.log.i(O,"onBluetoothDeviceFound-devices",e),e}return[]}function l(e){wx.onBluetoothDeviceFound(function(t){M.log.i(O,"onBluetoothDeviceFound-callback",t);var n=t.devices,r=u(n);e(r)})}function f(){M.log.i(O,"stopBluetoothDevicesDiscovery-start",arguments),wx.stopBluetoothDevicesDiscovery({complete:function(e){M.log.i(O,"stopBluetoothDevicesDiscovery-complete",arguments)}})}function _(e){wx.getBluetoothDevices({success:function(t){e.success(u(t.devices))},fail:e.fail,complete:e.complete})}function d(e,t){wx.getConnectedBluetoothDevices({success:function(n){e&&e(n.devices),t&&t.success&&t.success()}})}function h(e,t){M.log.i(O,"createBLEConnection-start",arguments),wx.createBLEConnection({timeout:t,deviceId:e,complete:function(e){M.log.i(O,"createBLEConnection-complete",e)}})}function g(e){M.log.i(O,"closeBLEConnection-start",arguments),wx.closeBLEConnection({deviceId:e,complete:function(e){M.log.i(O,"closeBLEConnection-complete",e)}})}function p(e){M.log.i(O,"onBLEConnectionStateChange-start"),wx.onBLEConnectionStateChange(function(t){M.log.i(O,"onBLEConnectionStateChange-callback",arguments);var n=t.connected?m.default.BLE_RET.Boolean.True:m.default.BLE_RET.Boolean.False;e({deviceId:t.deviceId,connected:n})})}function E(e,t,n,r){M.log.i(O,"discoverBLEServerAndCharacteristic-start",arguments),wx.getBLEDeviceServices({deviceId:e,complete:function(n){M.log.i(O,"getBLEDeviceServices-complete",arguments),wx.getBLEDeviceCharacteristics({deviceId:e,serviceId:t,success:function(e){M.log.i(O,"getBLEDeviceCharacteristics-success",arguments),r(m.default.BLE_RET.Boolean.True)}})}})}function v(e,t,n,r,o){M.log.i(O,"notifyBLECharacteristicValueChange-start",arguments),wx.notifyBLECharacteristicValueChange({state:w(r),deviceId:e,serviceId:t,characteristicId:n,success:function(e){M.log.i(O,"notifyBLECharacteristicValueChange-success",arguments),o(e)}})}function B(e,t,n,r,o,i){M.log.i(O,"writeBLECharacteristicValue-start",arguments),o instanceof Array&&(o=I.default.arr2Buffer(o)),wx.writeBLECharacteristicValue({deviceId:e,serviceId:t,characteristicId:n,value:o,success:function(e){M.log.i(O,"writeBLECharacteristicValue-success",arguments),i&&i(m.BLE_RET.status.suc)},fail:function(e){M.log.i(O,"writeBLECharacteristicValue-fail",arguments),i&&i(m.BLE_RET.status.fail)}})}function D(e){M.log.i(O,"onBLECharacteristicValueChange-start"),wx.onBLECharacteristicValueChange(function(t){var n=[];t&&t.value instanceof ArrayBuffer&&(n=I.default.buffer2Arr(t.value)),t.value=n,M.log.i(O,"onBLECharacteristicValueChange-callback",arguments),e(t)})}function y(){return 20}function b(e,t){t(20)}function A(e,t){return m.default.BLE_RET.Boolean.True}function C(){var e=wx.getSystemInfoSync();return P=e,M.log.i(O,"getSystemInfoSync-res",e),P}function T(){return void 0==P?C().platform:P}function w(e){return e===m.default.BLE_RET.Boolean.True}Object.defineProperty(t,"__esModule",{value:!0});var M=n(0),m=n(2),I=n(1),O="wxBleNative",P=void 0;t.default={$nativeName:"weixin",getSystemInfoSync:C,getPlatform:T,initializeBluetoothAdapter:r,openBluetoothAdapter:o,closeBluetoothAdapter:i,onBluetoothAdapterStateChange:a,getBluetoothAdapterState:s,startBluetoothDevicesDiscovery:c,onBluetoothDeviceFound:l,stopBluetoothDevicesDiscovery:f,getBluetoothDevices:_,getConnectedBluetoothDevices:d,createBLEConnection:h,closeBLEConnection:g,onBLEConnectionStateChange:p,discoverBLEServerAndCharacteristic:E,notifyBLECharacteristicValueChange:v,writeBLECharacteristicValue:B,onBLECharacteristicValueChange:D,getBluetoothMTU:y,setMTUSize:b,setBluetoothRecieveInterval:A}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"_const",function(){return o}),n.d(t,"INIT_CONF",function(){return a});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o={platform:{android:0,ios:1,other:2},nativeApp:{medica:1,weixin:2,hilink:3}},i=o.nativeApp.medica;"object"===("undefined"==typeof wx?"undefined":r(wx))&&wx.version?i=o.nativeApp.weixin:"undefined"==typeof hilink||r(hilink);var a={nativeApp:i}},function(e,t,n){"use strict";function r(){return Object(c.a)("getWiFiConnectionInfo")}function o(e){return Object(c.b)("startWiFiScan",void 0,e)}function i(e,t,n,r,o,i){return Object(c.b)("connectWiFi",{ssid:e,originalSsid:t,password:n,safeType:r,timeout:o},i)}function a(){return Object(c.a)("getWiFiIp")}function s(){return Object(c.a)("getNetworkState")}Object.defineProperty(t,"__esModule",{value:!0});var c=n(10);t.default={getWiFiConnectionInfo:r,startWiFiScan:o,connectWiFi:i,getWiFiIp:a,getNetworkState:s}},function(e,t,n){var r=n(1),o=n(3),i=o.Map,a=n(6),s=a.crc32buf,c=n(11),u=c.crc8buf,l=n(12),f=l.InvokerManager,_=n(0),d=_.log,h=n(0),g=h.setLogConfig,p=n(4),E=n(25),v=n(7),B=v.Queue,D=n(8),y=n(5),b=n(16),A=n(20),C=n(29),T=n(2),w=n(18),M=n(19),m=M.INIT_CONF,I=M._const,O=n(2),P=O.BLE_RET,S=O.FRAME_TYPE,R=O.DEVICE_TYPE,L=n(15),x=L.setBleNative,U=n(30),k=n(31),N=k.p200aBleApi;e.exports={medicaBle:D,medicaBleProtocol:y,medicaBleNative:b.default,medicaNetNative:A.default,medicaTcpNative:C.default,bleCommonApi:U,bufUtil:r.default,Map:i,crc32buf:s,crc8buf:u,InvokerManager:f,log:d,setLogConfig:g,math:p,md5:E,Queue:B,p200aBleApi:N,constants:T,wxBleNative:w.default,INIT_CONF:m,_const:I,setBleNative:x,BLE_RET:P,FRAME_TYPE:S,DEVICE_TYPE:R,version:"2.0.99"}},function(e,t,n){"use strict";function r(e,t){this.conf=null,this.rule=null,this.ws=null,this.clientId=0,this.i=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local&&!Object({NODE_ENV:"production",version:"2.0.99",PRODUCTION_TIME:"2024-8-12 16:46:44",channelId:14200,PRODUCTION_STATUS:2,UGLIFY_JS:!1,SLEEPACE_HOST:"https://m800test1.sleepace.com",TCP_SERVER:{IP:"120.24.169.204",PORT:27010}}).RELEASE){var o=n[0];(e.rule[o]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.log.apply(null,n))}e.sendLog2server("info",n)}catch(e){}},this.e=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local){var o=n[0];(e.rule[o]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.error.apply(null,n))}e.sendLog2server("error",n)}catch(e){}},this.w=function(){var e=this;try{for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(e.conf.log.local){var o=n[0];(e.rule[o]||e.rule.all)&&(n.push((new Date).getTime()),n.unshift(c),console.error.apply(null,n))}e.sendLog2server("warn",n)}catch(e){}},this.sendLog2server=function(e,t){var n=this;if(!this.conf.log.remote.available)return null;try{var r=t[0],o={type:"logLine",info:[],warn:[],err:[]};if(this.rule[r]||this.rule.remoteAll){for(var i=[c],a=0;a<t.length;a++){var u=t[a];"object"===s(t[a])&&(u=JSON.stringify(t[a])),i.push(u)}i.unshift(n.clientId),i.push((new Date).getTime());var l=i.join(" ");-1!==["info","warn","error"].indexOf(e)&&o[e].push(l),n.ws.wsSend(JSON.stringify(o))}}catch(e){console.error(c,"Comm.Error sendLog2server",e)}},this.createClientId=function(){this.clientId=a.a.getItem("wsClientId"),this.clientId||(this.clientId=Object(i.randomNum)(1e7,99999999),a.a.setItem("wsClientId",this.clientId)),console.warn(c,"REMOTE-LOG","wsClientId: ",this.clientId)},this.setLogConfig(e,t)}t.a=r;var o=n(23),i=n(4),a=n(24),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c="TAG:base",u={log:{local:!1,remote:{available:!1,url:""}}},l={all:!1,remoteAll:!1};r.prototype.setLogConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if("string"==typeof e)switch(e){case"local":e={all:!0,remoteAll:!1},t.log.local=!0;break;case"remote":e={all:!0,remoteAll:!0},t.log.local=!1;break;case"all":e={all:!0,remoteAll:!0},t.log.local=!0;break;default:e=l}this.rule=e,this.conf=t,this.ws&&this.ws.close(),this.ws=new o.a({websocket:{available:this.conf.log.remote.available,url:this.conf.log.remote.url}}),this.ws.initWebSocket(),this.createClientId()}},function(e,t,n){"use strict";function r(e){this.conf=e||i,this.ws=void 0,this.connected=!1,this.msgCache=new o.default.Queue,this.keepAliveId=null,this.initWebSocket=function(){var t=this;try{if(!this.conf.websocket.available)return null;if(!this.ws||!this.connected){var n=!1;this.ws||(this.ws=new WebSocket(e.websocket.url),n=!0),(n||t.ws.readyState===t.ws.CLOSED)&&(t.ws.onopen=function(){console.log("TAG:base websocket open"),t.connected=!0,t.sendCache()},t.ws.onclose=function(){console.log("TAG:base websocket close"),t.connected=!1,t.ws=void 0},t.ws.onmessage=function(e){})}}catch(e){console.error("TAG:base Comm.Error websocket init",e)}},this.sendCache=function(){var e=this;this.conf.websocket.available&&setTimeout(function(){e.ws.readyState===e.ws.OPEN&&e.msgCache.count()>0&&(e.wsSend(e.msgCache.front()),e.msgCache.dequeue()),e.sendCache()},100)},this.wsSend=function(e){var t=this;try{t.conf.websocket.available&&(t.ws.readyState===t.ws.OPEN?t.ws.send(e):(t.msgCache.enqueue(e),console.error("TAG:base Comm.Error","WebSocket connected:",t.ws.readyState,"send later")))}catch(e){console.error("TAG:base sendError",e)}},this.keepAlive=function(){var e=this;this.conf.websocket.available&&(e.keepAliveId=setInterval(function(){e.initWebSocket()},500))},this.keepAlive()}t.a=r;var o=n(7),i={websocket:{available:!1,url:""}};r.prototype.close=function(){this.keepAliveId&&clearInterval(this.keepAliveId),this.ws&&this.ws.close()}},function(e,t,n){"use strict";function r(e){try{return wx?wx.getStorageSync(e):localStorage.getItem(e)}catch(t){return a.get(e)}}function o(e,t){try{wx?wx.setStorageSync(e,t):localStorage.setItem(e,t)}catch(n){a.put(e,t)}}var i=n(3),a=new i.Map;t.a={getItem:r,setItem:o}},function(e,t){function n(e){return _(r(f(e),e.length*h))}function r(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,o=-1732584194,l=271733878,f=0;f<e.length;f+=16){var _=n,d=r,h=o,g=l;n=i(n,r,o,l,e[f+0],7,-680876936),l=i(l,n,r,o,e[f+1],12,-389564586),o=i(o,l,n,r,e[f+2],17,606105819),r=i(r,o,l,n,e[f+3],22,-1044525330),n=i(n,r,o,l,e[f+4],7,-176418897),l=i(l,n,r,o,e[f+5],12,1200080426),o=i(o,l,n,r,e[f+6],17,-1473231341),r=i(r,o,l,n,e[f+7],22,-45705983),n=i(n,r,o,l,e[f+8],7,1770035416),l=i(l,n,r,o,e[f+9],12,-1958414417),o=i(o,l,n,r,e[f+10],17,-42063),r=i(r,o,l,n,e[f+11],22,-1990404162),n=i(n,r,o,l,e[f+12],7,1804603682),l=i(l,n,r,o,e[f+13],12,-40341101),o=i(o,l,n,r,e[f+14],17,-1502002290),r=i(r,o,l,n,e[f+15],22,1236535329),n=a(n,r,o,l,e[f+1],5,-165796510),l=a(l,n,r,o,e[f+6],9,-1069501632),o=a(o,l,n,r,e[f+11],14,643717713),r=a(r,o,l,n,e[f+0],20,-373897302),n=a(n,r,o,l,e[f+5],5,-701558691),l=a(l,n,r,o,e[f+10],9,38016083),o=a(o,l,n,r,e[f+15],14,-660478335),r=a(r,o,l,n,e[f+4],20,-405537848),n=a(n,r,o,l,e[f+9],5,568446438),l=a(l,n,r,o,e[f+14],9,-1019803690),o=a(o,l,n,r,e[f+3],14,-187363961),r=a(r,o,l,n,e[f+8],20,1163531501),n=a(n,r,o,l,e[f+13],5,-1444681467),l=a(l,n,r,o,e[f+2],9,-51403784),o=a(o,l,n,r,e[f+7],14,1735328473),r=a(r,o,l,n,e[f+12],20,-1926607734),n=s(n,r,o,l,e[f+5],4,-378558),l=s(l,n,r,o,e[f+8],11,-2022574463),o=s(o,l,n,r,e[f+11],16,1839030562),r=s(r,o,l,n,e[f+14],23,-35309556),n=s(n,r,o,l,e[f+1],4,-1530992060),l=s(l,n,r,o,e[f+4],11,1272893353),o=s(o,l,n,r,e[f+7],16,-155497632),r=s(r,o,l,n,e[f+10],23,-1094730640),n=s(n,r,o,l,e[f+13],4,681279174),l=s(l,n,r,o,e[f+0],11,-358537222),o=s(o,l,n,r,e[f+3],16,-722521979),r=s(r,o,l,n,e[f+6],23,76029189),n=s(n,r,o,l,e[f+9],4,-640364487),l=s(l,n,r,o,e[f+12],11,-421815835),o=s(o,l,n,r,e[f+15],16,530742520),r=s(r,o,l,n,e[f+2],23,-995338651),n=c(n,r,o,l,e[f+0],6,-198630844),l=c(l,n,r,o,e[f+7],10,1126891415),o=c(o,l,n,r,e[f+14],15,-1416354905),r=c(r,o,l,n,e[f+5],21,-57434055),n=c(n,r,o,l,e[f+12],6,1700485571),l=c(l,n,r,o,e[f+3],10,-1894986606),o=c(o,l,n,r,e[f+10],15,-1051523),r=c(r,o,l,n,e[f+1],21,-2054922799),n=c(n,r,o,l,e[f+8],6,1873313359),l=c(l,n,r,o,e[f+15],10,-30611744),o=c(o,l,n,r,e[f+6],15,-1560198380),r=c(r,o,l,n,e[f+13],21,1309151649),n=c(n,r,o,l,e[f+4],6,-145523070),l=c(l,n,r,o,e[f+11],10,-1120210379),o=c(o,l,n,r,e[f+2],15,718787259),r=c(r,o,l,n,e[f+9],21,-343485551),n=u(n,_),r=u(r,d),o=u(o,h),l=u(l,g)}return Array(n,r,o,l)}function o(e,t,n,r,o,i){return u(l(u(u(t,e),u(r,i)),o),n)}function i(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function a(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function c(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}function u(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function l(e,t){return e<<t|e>>>32-t}function f(e){for(var t=Array(),n=(1<<h)-1,r=0;r<e.length*h;r+=h)t[r>>5]|=(e.charCodeAt(r/h)&n)<<r%32;return t}function _(e){for(var t=d?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}var d=0,h=8;e.exports={hex_md5:n}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){var e=new ArrayBuffer(0),t=[],n=function(t){e=t},o=function(t){n(e.append(t))},c=function(){var t=a.a.cutArrayBufferWithSeparator(e,s.a.separator),r=t.left,o=t.bufferAry;return n(r),o},u=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=Object(i.c)(r);o&&t.push(o)}return t},l=function(){if(0==t.length)return[];for(var e=[];0!=t.length;){var n=t[0],r=n.frameNumber;if(1!=r)if(0==n.frameIndex){var o=r;t.length<o&&(o=n.length);for(var a=n.frameSequence,s=!1,c=1;c<o;c++){var u=t[c];if(u.frameSequence!=a||u.frameIndex!=c){s=!0,t.splice(0,c);break}}if(!s){if(t.length<r)break;for(var l=new ArrayBuffer(0),f=0;f<r;f++){var _=t[f];_._payload&&(l=l.append(_._payload))}t.splice(0,r),n.frameNumber=1,n.frameIndex=0,n._payload=l,e.push(n)}}else t.shift();else e.push(n),t.shift()}return e.triggerEach(function(e){Object(i.b)(e)}),e};this.appendData=function(e){o(e);var n=c(),i=u(n);if(i&&i.length>0){var a;(a=t).push.apply(a,r(i))}return l()},this.empty=function(){e=new ArrayBuffer(0),t=[]}}t.a=o;var i=n(13),a=(n(1),n(14)),s=n(9)},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,function(global){"use strict";var _Base64=global.Base64,version="2.4.9",buffer;if(void 0!==module&&module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),t>=2?"=":b64chars.charAt(n>>>6&63),t>=1?"=":b64chars.charAt(63&n)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return fromCharCode(55296+(n>>>10))+fromCharCode(56320+(1023&n));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,n=t%4,r=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),o=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return o.length-=[0,0,2,1][n],o.join("")},atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,cb_decode)},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),void 0!==module&&module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}})}).call(exports,__webpack_require__(17))},function(e,t,n){"use strict";function r(e){var t=window.location.hash.match(new RegExp("(?:#|&)"+e+"=([^&]*)(&|$)"));return(t?decodeURIComponent(t[1]):"")||o(e)}function o(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}function i(e){e=e||location.href;var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},r=t.search.replace(/^\?/,"").split("&"),o=r.length,i=0;i<o;i++)r[i]&&(e=r[i].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[void 0,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[void 0,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}}t.a={getParameter:r,getParameterByName:o,urlParse:i}},function(e,t,n){"use strict";function r(e,t,n){return Object(_.b)("connectSocket",{ip:e,port:t},n)}function o(e){return Object(_.b)("onSocketStateChange",void 0,e)}function i(e,t,n){return Object(_.b)("closeSocket",{ip:e,port:t},n)}function a(e,t,n,r){return Object(_.b)("sendSocketMessage",{ip:e,port:t,value:n},r)}function s(e){return Object(_.b)("onMessage",void 0,e)}function c(e,t,n){return Object(_.a)("getSocketState",{ip:e,port:t})}function u(e){return Object(_.b)("onNetworkStateChange",void 0,e)}function l(e,t,n,r,o){return Object(_.b)("sendMulticast",{ip:e,port:t,deviceType:r,deviceName:n},o)}function f(e,t,n,r){return Object(_.b)("getUdpServerAddress",{ssid:e,password:t,timeout:n},r)}Object.defineProperty(t,"__esModule",{value:!0});var _=n(10),d=n(20);t.default={connectSocket:r,closeSocket:i,getSocketState:c,onSocketStateChange:o,sendSocketMessage:a,onMessage:s,onNetworkStateChange:u,sendMulticast:l,getUdpServerAddress:f,getNetworkState:d.default.getNetworkState}},function(e,t,n){"use strict";function r(){this.conf=h}function o(e){var t={},n=new DataView(e);return t.alarmId=n.get8x(1),t.alarmFlag=n.get1x(1),t.smartFl=n.get1x(1),t.smartOffset=n.get1x(1),t.hour=n.get1x(1),t.minute=n.get1x(1),t.week=n.get1x(1),t.lazyCount=n.get1x(1),t.lazyTime=n.get1x(1),t.volume=n.get1x(1),t.brightness=n.get1x(1),t.aromaRate=n.get1x(1),t.oscillatorFlag=n.get1x(1),t}function i(e,t){var n=e.get1x(1),r=void 0;switch(n){case 0:case 1:r=e.get2x(1);break;case 3:r=e.get4x(1);break;case 2:case 6:case 7:t.albumId=e.get4x(1),r=e.get4x(1),t.currentIndex=e.get2x(1),t.playMode=e.get1x(1)}t.cycle=e.get1x(1),t.musicType=n,t.musicId=r}function a(e,t,n){switch(e){case 2:n.fluxaySeqid=t.get1x(1);break;case 0:case 1:n.r=t.get1x(1),n.g=t.get1x(1),n.b=t.get1x(1),n.w=t.get1x(1)}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"AromaScheduleOperation",function(){return d}),n.d(t,"bleConf1",function(){return h}),t.BleCommon1=r;var s=n(8),c=n(5),u=n(0),l=n(1),f=n(2),_=n(4),d={Invalid:0,DeleteAll:1,DeleteSingle:2,ModifyList:3,SetList:4,Enalbe:5,Disable:6},h=s.MedicaBle.getBleDefaultConfig();h.protocol=new c.MedicaProtocol1,r.prototype=new s.MedicaBle,r.prototype.checkTime=function(e){var t=new DataView(new ArrayBuffer(13));t.set4x(e.timestamp),t.set4x(e.timezoneOffset),t.set1x(e.season),t.set4x(e.seasonOffset),e.content=t.buffer,this.sendMsgOperation(16,f.FRAME_TYPE.Request,e)},r.prototype.getSystemInfo=function(e){this.sendMsgOperation(17,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};n.deviceName=l.default.buf2string(t.buffer.slice(9,22)),n.deviceId=l.default.buf2string(t.buffer.slice(23,36)),n.deviceType=t.getUint16(37),n.currVersion=t.getUint16(39),n.currVersion=Object(_.padStart)(parseInt(n.currVersion/100),1,0)+"."+Object(_.padStart)(parseInt(n.currVersion%100)),n.facVersion=t.getUint16(41),n.facVersion=Object(_.padStart)(parseInt(n.facVersion/100),1,0)+"."+Object(_.padStart)(parseInt(n.facVersion%100)),n.facTime=t.getUint32(43),n.manufacCode=t.getUint16(47),n.coopCode=t.getUint16(49),n.pcbVersion=t.getUint8(51)+"."+t.getUint8(52);var r=53;t.byteLength>=73&&(n.wifiMac=[t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++),t.getUint8(r++)].map(function(e){return Object(_.padStart)(e.toString(16))}).join(":"));var o=t.getUint8(r++),i=t.getUint8(r++),a=t.getUint8(r++),s=t.getUint8(r++),c=t.getUint8(r++),u=t.getUint8(r++),f=[u,c,s,a,i,o].map(function(e){return Object(_.padStart)(e.toString(16))}).join(":").toUpperCase();return n.deviceMac=f,n})},r.prototype.getSystemVersion=function(e){this.sendMsgOperation(18,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return t.position=9,n.currVersion1=t.get1x(1),n.currVersion2=t.get1x(1),n.currVersion=n.currVersion1+"."+n.currVersion2,n})},r.prototype.retSystemInfo=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(19,f.FRAME_TYPE.Request,e)},r.prototype.userInfo=function(e){var t=new DataView(new ArrayBuffer(6));t.set1x(1),t.set4x(e.userId),t.set1x(e.language),e.content=t.buffer,this.sendMsgOperation(32,f.FRAME_TYPE.Request,e)},r.prototype.sceneConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.number),e.content=t.buffer.append(e.sceneData),this.sendMsgOperation(33,f.FRAME_TYPE.Request,e)},r.prototype.sleepSceneContentData=function(e){var t=new DataView(new ArrayBuffer(13));t.set8x(e.sceneId),t.set1x(e.enable),t.set1x(e.sceneType),t.set1x(e.monitorSwitch),t.set2x(e.monitorType);for(var n=l.default.str2ab(e.monitorDeviceId),r=n.byteLength,o=r;o<14;o++){var i=new DataView(new ArrayBuffer(1));i.set1x(0),n=n.append(i.buffer)}var a=t.buffer.append(n),s=new DataView(new ArrayBuffer(1));s.set1x(e.assistSwitch);var c=a.append(s.buffer),u=c.append(e.sleepAssistModel.contentData),f=new DataView(new ArrayBuffer(1));return f.set1x(e.alarmSwitch),u.append(f.buffer)},r.prototype.sleepAssistModel=function(e){var t=e.lightSwitch,n=e.musicSwitch,r=e.aromaSwitch,o=0;n&&(o|=1),t&&(o|=2),r&&(o|=4);var i=new DataView(new ArrayBuffer(11));i.set1x(e.sleepSwitch),i.set1x(o),i.set1x(e.volume),i.set1x(e.brightness),i.set1x(e.r),i.set1x(e.g),i.set1x(e.b),i.set1x(e.w),i.set1x(e.rate),i.set1x(e.smartStop),i.set1x(e.aidingTime);var a={};return a.contentData=i.buffer,a},r.prototype.colockConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.number);for(var n=t.buffer,r=0;r<e.alarmListData.length;r++){var o=e.alarmListData[r];n=n.append(o.content)}e.content=n,this.sendMsgOperation(35,f.FRAME_TYPE.Request,e)},r.prototype.getClockConfig=function(e){var t=new DataView(new ArrayBuffer(1));t.set1x(0),e.content=t.buffer,this.sendMsgOperation(35,f.FRAME_TYPE.Request,e,function(e){var t=new Array,n=new DataView(e);n.position=9;for(var r=(n.get1x(1),n.get1x(1)),a=0;a<r;a++){var s=n.position,c=s+20,u=o(n.buffer.slice(s,c));n.position=c,i(n,u),u.timestamp=n.get4x(1),t.push(u)}return t})},r.prototype.alarmContentData=function(e){var t=this.musicData(e),n=new DataView(new ArrayBuffer(20));n.set8x(e.alarmId),n.set1x(e.alarmFlag),n.set1x(e.smartFlag),n.set1x(e.smartOffset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.week),n.set1x(e.lazyCount),n.set1x(e.lazyTime),n.set1x(e.volume),n.set1x(e.brightness),n.set1x(e.aromaRate),n.set1x(e.oscillatorFlag);var r=n.buffer.append(t),o=new DataView(new ArrayBuffer(4));return o.set4x(e.timestamp),e.content=r.append(o.buffer),e},r.prototype.musicData=function(e){var t;switch(e.musicType){case f.MUSIC_TYPE.LOCAL:case f.MUSIC_TYPE.OUTSITE:t=new DataView(new ArrayBuffer(4)),t.set1x(e.musicType),t.set2x(e.musicId),t.set1x(e.cycle);break;case f.MUSIC_TYPE.XMLY_SIGLE:t=new DataView(new ArrayBuffer(6)),t.set1x(e.musicType),t.set4x(e.musicId),t.set1x(e.cycle);case f.MUSIC_TYPE.XMLY_ALBUM:case f.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case f.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t=new DataView(new ArrayBuffer(13)),t.set1x(e.musicType),t.set4x(e.albumId),t.set4x(e.musicId),t.set2x(e.currentIndex),t.set1x(e.playMode),t.set1x(e.cycle)}return t.buffer},r.prototype.lightConfig=function(e){var t=new DataView(new ArrayBuffer(8));t.set1x(1),t.set1x(e.lightness),t.set1x(e.r),t.set1x(e.g),t.set1x(e.b),t.set1x(e.w),t.set2x(e.duration),e.content=t.buffer,this.sendMsgOperation(38,f.FRAME_TYPE.Request,e)},r.prototype.albumConfig=function(e){var t=new DataView(new ArrayBuffer(8));t.set1x(1),t.set1x(e.musicType),t.set4x(e.albumId),t.set2x(e.voiceNumber),e.content=t.buffer.append(e.endData),this.sendMsgOperation(39,f.FRAME_TYPE.Request,e)},r.prototype.musicListData=function(e){for(var t=new DataView(new ArrayBuffer(4*e.length)),n=0;n<e.length;n++){var r=e[n];switch(r.musicType){case f.MUSIC_TYPE.LOCAL:t.set2x(r.musicId);break;case f.MUSIC_TYPE.XMLY_ALBUM:case f.MUSIC_TYPE.XMLY_SIGLE:case f.MUSIC_TYPE.CUSTOMIZEDXMLY_ALBUM:case f.MUSIC_TYPE.CUSTOMIZED_LOCAL_ALBUM:t.set4x(r.musicId)}}return t.buffer},r.prototype.centerFuntionSet=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(1),t.set1x(e.lightSwitch),t.set1x(e.musicSwitch),t.set1x(e.fragranceSwitch),e.content=t.buffer,this.sendMsgOperation(44,f.FRAME_TYPE.Request,e)},r.prototype.timingSwitchConfig=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.operation),e.content=t.buffer.append(e.endData),this.sendMsgOperation(45,f.FRAME_TYPE.Request,e)},r.prototype.timingData=function(e,t){var n=new DataView(new ArrayBuffer(0));switch(t){case d.Invalid:n=new DataView(new ArrayBuffer(0));break;case d.DeleteSingle:case d.Enalbe:case d.Disable:n=new DataView(new ArrayBuffer(8)),n.set8x(e.seqId);break;case d.ModifyList:n=new DataView(new ArrayBuffer(16)),n.set1x(1),n.set8x(e.seqId),n.set1x(e.isOpen),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.week),n.set2x(e.duration),n.set1x(e.rate)}return n.buffer},r.prototype.pinSet=function(e){var t=new DataView(new ArrayBuffer(2));t.set1x(1),t.set1x(e.on),e.content=t.buffer,this.sendMsgOperation(46,f.FRAME_TYPE.Request,e)},r.prototype.ligthSwitchOpertaion=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(3));n.set1x(t),n.set1x(Math.min(e.brightness,100)),n.set1x(e.lightMode),0==e.operation&&(e.endData=new ArrayBuffer(0)),e.content=n.buffer.append(e.endData),this.sendMsgOperation(48,f.FRAME_TYPE.Request,e)},r.prototype.lightData=function(e,t){switch(e){case 2:var n=new DataView(new ArrayBuffer(1));return n.set1x(t.fluxaySeqid),n.buffer;case 0:case 1:var n=new DataView(new ArrayBuffer(4));return n.set1x(t.r),n.set1x(t.g),n.set1x(t.b),n.set1x(t.w),n.buffer}},r.prototype.musicOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=void 0;switch(e.operation){case 1:case 3:case 4:var r=new DataView(new ArrayBuffer(2));r.set1x(t),r.set1x(e.volume),n=r.buffer.append(e.endData);break;case 5:var r=new DataView(new ArrayBuffer(1));r.set1x(t),n=r.buffer.append(e.endData);break;default:var r=new DataView(new ArrayBuffer(1));r.set1x(t)}e.content=n,this.sendMsgOperation(49,f.FRAME_TYPE.Request,e)},r.prototype.fragranceOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(2));n.set1x(t),n.set1x(e.rate),e.content=n.buffer,this.sendMsgOperation(55,f.FRAME_TYPE.Request,e)},r.prototype.oneKeySwitchOperation=function(e){var t=15&e.operation|e.mode<<4&240,n=new DataView(new ArrayBuffer(1));n.set1x(t),e.content=n.buffer.append(e.endData),this.sendMsgOperation(56,f.FRAME_TYPE.Request,e)},r.prototype.sceneOperation=function(e){var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set8x(e.sceneNumber),e.content=t.buffer.append(e.endData),this.sendMsgOperation(50,f.FRAME_TYPE.Request,e)},r.prototype.sceneOperationData=function(e,t){var n,r=l.default.buffer2Arr(this.musicData(t));switch(e){case 1:case 2:n=new DataView(new ArrayBuffer(3)),n.set1x(t.lightSwitch),n.set1x(t.musicSwitch),n.set1x(t.fragranceSwitch),r=r.concat(l.default.buffer2Arr(n.buffer))}return l.default.arr2Buffer(r)},r.prototype.asistSleepOperation=function(e){var t=new DataView(new ArrayBuffer(4));t.set1x(e.request),t.set1x(e.lightSwitch),t.set1x(e.musicSwitch),t.set1x(e.fragranceSwitch),e.content=t.buffer,this.sendMsgOperation(51,f.FRAME_TYPE.Request,e)},r.prototype.clockOperation=function(e){var t=new DataView(new ArrayBuffer(9));t.set1x(e.operation),t.set8x(e.alarmSeqid),e.content=e.endData.byteLength>0?t.buffer.append(e.endData):t.buffer,this.sendMsgOperation(52,f.FRAME_TYPE.Request,e)},r.prototype.alarmData=function(e,t){var n,r=new ArrayBuffer(0);switch(e){case 3:var o=this.musicData(t);n=new DataView(new ArrayBuffer(3)),n.set1x(t.volume),n.set1x(t.brightness),n.set1x(t.aromaRate),r=n.buffer.append(o)}return r},r.prototype.previewOperation=function(e){var t=new DataView(new ArrayBuffer(3));t.set1x(e.request),t.set1x(e.exit),t.set1x(e.reset),e.content=t.buffer,this.sendMsgOperation(53,f.FRAME_TYPE.Request,e)},r.prototype.queryStatus=function(e){this.sendMsgOperation(64,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return t.position=9,n.status=t.get1x(1),n})},r.prototype.queryWorkMode=function(e){var t=this;this.sendMsgOperation(65,f.FRAME_TYPE.Request,e,function(e){return Object.assign(t.fillWithResponseAndPostData({msgType:65,buffer:e,isPost:!1}))})},r.prototype.queryMusicList=function(e){this.sendMsgOperation(66,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;for(var n=t.get1x(1),r={},o=new Array,i=0;i<n;i++)o.push(t.get1x(1));return r.musicList=o,r})},r.prototype.queryPlayProgress=function(e){this.sendMsgOperation(69,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e);t.position=9;var n={};return n.status=t.get1x(1),n.duration=t.get2x(1),n.volume=t.get1x(1),i(t,n),n})},r.prototype.queryUpgradeProgress=function(e){this.sendMsgOperation(79,f.FRAME_TYPE.Request,e,function(e){var t=new DataView(e),n={};return n.status=t.getUint8(9),n.version=t.getUint16(10),n.progress=t.getUint32(12),n})},r.prototype.uploadUpgradeInfo=function(e){var t=new DataView(new ArrayBuffer(5+e.urlAddress.length));t.set2x(e.currentVersion),t.set2x(e.upgradeVersion),t.set1x(e.type),t.setStr(e.urlAddress,e.urlAddress.length),e.content=t.buffer,this.sendMsgOperation(81,f.FRAME_TYPE.Request,e)},r.prototype.netSet=function(e){var t=new ArrayBuffer(100),n=new DataView(t);n.set1x(1),n.set1x(e.controlType);for(var r=l.default.str2ab(e.socketIp),o=new DataView(r),i=r.byteLength,a=0;a<32;a++)a<i?n.set1x(o.getUint8(a)):n.set1x(0);n.set2x(e.port);for(var s=l.default.str2ab(e.httpIp),c=new DataView(s),u=s.byteLength,_=0;_<64;_++)_<u?n.set1x(c.getUint8(_)):n.set1x(0);e.content=n.buffer,this.sendMsgOperation(46,f.FRAME_TYPE.Request,e)},r.prototype.wifiConfig=function(e){var t=new ArrayBuffer(121),n=new DataView(t);n.set1x(1);for(var r=l.default.str2ab(e.SSID),o=new DataView(r),i=e.SSID.length,a=0;a<33;a++)a<i?n.set1x(o.getUint8(a)):n.set1x(0);n.set1x(e.pswMode);for(var s=l.default.str2ab(e.psw),c=new DataView(s),u=e.psw?e.psw.length:0,_=0;_<65;_++)_<u?n.set1x(c.getUint8(_)):n.set1x(0);n.set1x(e.ipMode);for(var d=e.staticIp,h=d?d.length:0,g=0;g<4;g++)g<h?n.set1x(d[g]):n.set1x(0);for(var p=e.subNetMask,E=p?p.length:0,v=0;v<4;v++)v<E?n.set1x(p[v]):n.set1x(0);for(var B=e.gateWay,D=B?B.length:0,y=0;y<4;y++)y<D?n.set1x(B[y]):n.set1x(0);for(var b=e.dns1,A=b?b.length:0,C=0;C<4;C++)C<A?n.set1x(b[C]):n.set1x(0);for(var T=e.dns2,w=T?T.length:0,M=0;M<4;M++)M<w?n.set1x(T[M]):n.set1x(0);e.content=n.buffer,this.sendMsgOperation(37,f.FRAME_TYPE.Request,e)},r.prototype.queryWifiStatus=function(e){this.sendMsgOperation(67,f.FRAME_TYPE.Request,e,function(e){return new DataView(e).getUint8(9)})},r.prototype.sendMsgOperation=function(e,t,n,r){var o={content:n.content||new ArrayBuffer(0),timeout:n.timeout||1e4,msgType:e,frameType:t,handler:function(e,t,o){var i;e!=f.BLE_RET.status.suc?n.handler&&n.handler(e):n.handler&&(null==t&&(t=new ArrayBuffer(0)),r?(i=r(t),n.handler(f.BLE_RET.status.suc,i)):n.handler(f.BLE_RET.status.suc))}};this.sendPacket(o)},r.prototype.fillWithResponseAndPostData=function(e){var t={},n=new DataView(e.buffer);switch(e.isPost?n.position=8:n.position=9,e.msgType){case 65:t.mode=n.get1x(1),t.sceneNumbers=n.get1x(1),t.sceneNumbers>0&&(t.sceneId=n.get8x(1),t.sceneType=n.get1x(1)),t.sleepAssistStatus=n.get1x(1),t.sleepAssistLeftTime=n.get1x(1),t.alarmStatus=n.get1x(1),t.alarmId=n.get8x(1),t.lightStatus=n.get1x(1),t.lightBrightness=n.get1x(1),t.lightMode=n.get1x(1),a(t.lightMode,n,t),t.aromaStatus=n.get1x(1),t.musicStatus=n.get1x(1),t.volume=n.get1x(1),i(n,t),u.log.i("===work ==:",l.default.buffer2Arr(n.buffer))}return t},r.prototype.sendUpgradeSummary=function(e){var t=new ArrayBuffer(14),n=new DataView(t);n.set2x(e.version),n.set4x(e.length),e.crcDes&&n.set4x(e.crcDes),e.crcBin&&n.set4x(e.crcBin),e.content=n.buffer,this.sendMsgOperation(e.msgType,f.FRAME_TYPE.Request,e)},r.prototype.sendUpgradeDetail=function(e){var t=new ArrayBuffer(6+e.content.length),n=new DataView(t);n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.content.length;r++)n.set1x(e.content[r]);e.content=n.buffer,this.sendMsgOperation(e.msgType,f.FRAME_TYPE.Request,e)}},function(e,t,n){"use strict";function r(){this.deviceType=i.DEVICE_TYPE.DEVICE_TYPE_P200A,this.setMtuEnable=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.P200aBleApi=r,n.d(t,"p200aBleApi",function(){return c});var o=n(32),i=n(2),a=n(1),s=n(0);r.prototype=new o.a,r.prototype.queryP200aSummery=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(36,i.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});t.count=e.getUint16(13),t.dataList=[];for(var n=0;n<t.count;n++){var r={};r.startTime=e.getUint32(23*n+15),r.timeStep=e.getUint16(23*n+15+4),r.recordCount=e.getUint32(23*n+15+4+2),r.stopMode=e.getUint8(23*n+15+4+2+4),r.firmwareVers=a.default.buf2string(e.buffer.slice(23*n+15+4+2+4+1,23*n+15+4+2+4+1+8)),t.dataList.push(r)}return t})},r.prototype.downloadP200SubHistoryData=function(e){var t=new ArrayBuffer(10),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),e.content=n.buffer,this.sendMsgOperation(35,i.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.data1=[],t.data2=[],t.data3=[],t.data4=[];for(var n=0;n<t.count;n++)t.data1[n]=e.getUint32(16*n+0+22,!0)<<0,t.data2[n]=e.getUint32(16*n+4+22,!0)<<0,t.data3[n]=e.getUint32(16*n+8+22,!0)<<0,t.data4[n]=e.getUint32(16*n+12+22,!0)<<0;return t})},r.prototype.downloadP200aSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,o=function(o,a){if(o!==i.BLE_RET.status.timeout||t<=1)return void(n&&n(o,a));e.handler=n,r.downloadP200aSubHistoryDataTryTimes(e,t-1)};e.handler=o,e.timeout=2e3,r.downloadP200SubHistoryData(e)},r.prototype.downloadP200aSingleReport=function(e,t,n,r,o,a){var s=this,c=function(c,u){return c!=i.BLE_RET.status.suc?void(a&&a(c)):(o.detail.data1.push.apply(o.detail.data1,u.data1),o.detail.data2.push.apply(o.detail.data2,u.data2),o.detail.data3.push.apply(o.detail.data3,u.data3),o.detail.data4.push.apply(o.detail.data4,u.data4),r+n>=e.recordCount?void(a&&a(c)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void s.downloadP200aSingleReport(e,t,n,r,o,a)))},u={offset:n,count:r,evDataEnable:t};u.startTime=e.startTime,u.handler=c,s.downloadP200aSubHistoryDataTryTimes(u,10)},r.prototype.downloadP200aReports=function(e,t,n,r,o){var a=e.length,s=this,c={detail:{data1:[],data2:[],data3:[],data4:[]}},u=function(u){return u!==i.BLE_RET.status.suc?void(o&&o(u)):(r&&r(n,c),++n>=a?void(o&&o(u)):void s.downloadP200aReports(e,t,n,r,o))};this.downloadP200aSingleReport(e[n],t,0,40,c,u)},r.prototype.downloadP200aHistoryData=function(e){var t=this,n=function(n,r){if(s.log.i("P200A-api","queryP200aSummery, ",n,r),n!=i.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var o=r.dataList;if(e.summaryHandle&&e.summaryHandle(o.length),0===o.length)return void e.completion(i.BLE_RET.status.suc,[]);var a=[],c=function(t,n){n.summary=o[t],e.everyReportHandle&&(e.everyReportHandle(t,o.length,n),a.push(n))};s.log.i("downloadP200aReports start");var u=function(t){s.log.i("downloadP200aReports complete"),e.completion&&e.completion(t,a)};t.downloadP200aReports(o,e.evDataEnable,0,c,u)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.queryP200aSummery(r)};var c=new r;c.initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.deviceType=a.DEVICE_TYPE.DEVICE_TYPE_PILLOW,this.setMtuEnable=!1}function o(e,t){var n={},r=void 0;return e&&(r=e.timeout),r&&(n.timeout=r),n.content=t||new ArrayBuffer(0),n}t.a=r;var i=n(33),a=n(2),s=n(0);r.prototype=new i.a,r.prototype.getHistoryDataSummary=function(e){var t=new DataView(new ArrayBuffer(8));t.set4x(e.startTime),t.set4x(e.endTime),this.sendMsgOperation(80,a.FRAME_TYPE.Request,o(e,t.buffer),function(t,n){if(e.handler){var r={};if(t===a.BLE_RET.status.suc){var o=new DataView(n);r.count=o.getUint8(9),r.dataList=new Array;for(var i=0;i<r.count;i++){var s={};s.startTime=o.getUint32(8*i+10),s.Interval=o.getUint8(8*i+10+4),s.recordCount=o.getUint16(8*i+10+4+1),s.stopMode=o.getUint8(8*i+10+4+1+2),r.dataList[i]=s}}e.handler(t,r)}})},r.prototype.downloadSubHistoryData=function(e){var t=new ArrayBuffer(19),n=new DataView(t);n.set4x(e.startTime),n.set4x(e.offset),n.set2x(e.count),n.set1x(4),n.set1x(0),n.set1x(1),n.set1x(1),n.set1x(1),n.set1x(2),n.set1x(1),n.set1x(3),n.set1x(1),e.content=n.buffer,this.sendMsgOperation(11,a.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.heartRate=new Array,t.breathRate=new Array,t.status=new Array,t.statusValue=new Array;for(var n=0;n<t.count;n++)t.breathRate[n]=e.getUint8(4*n+31),t.heartRate[n]=e.getUint8(4*n+31+1),t.status[n]=e.getUint8(4*n+31+1+1),t.statusValue[n]=e.getUint8(4*n+31+1+1+1);return t})},r.prototype.downloadSubHistoryDataTryTimes=function(e,t){var n=e.handler,r=this,o=function(o,i){if(o!==a.BLE_RET.status.timeout||t<=1)return void(n&&n(o,i));e.handler=n,r.downloadSubHistoryDataTryTimes(e,t-1)};e.handler=o,e.timeout=2e3,r.downloadSubHistoryData(e)},r.prototype.downloadSingleReport=function(e,t,n,r,o,i){var c=this,u=function(s,u){return s!=a.BLE_RET.status.suc?void(i&&i(s)):(o.detail.breathRate.push.apply(o.detail.breathRate,u.breathRate),o.detail.heartRate.push.apply(o.detail.heartRate,u.heartRate),o.detail.status.push.apply(o.detail.status,u.status),o.detail.statusValue.push.apply(o.detail.statusValue,u.statusValue),r+n>=e.recordCount?void(i&&i(s)):(n+=r,r+n>=e.recordCount&&(r=e.recordCount-n),void c.downloadSingleReport(e,t,n,r,o,i)))},l={offset:n,count:r,evDataEnable:t};l.startTime=e.startTime,l.handler=u,s.log.i("downloadSubHistoryDataTryTimes: ",l.startTime),c.downloadSubHistoryDataTryTimes(l,10)},r.prototype.downloadReports=function(e,t,n,r,o){var i=e.length,s=this,c={detail:{breathRate:[],heartRate:[],status:[],statusValue:[]}},u=function(u){return u!==a.BLE_RET.status.suc?void(o&&o(u)):(r&&r(n,c),++n>=i?void(o&&o(u)):void s.downloadReports(e,t,n,r,o))};this.downloadSingleReport(e[n],t,0,40,c,u)},r.prototype.downloadHistoryData=function(e){var t=this,n=function(n,r){if(n!=a.BLE_RET.status.suc)return void(e.completion&&e.completion(n));var o=r.dataList;if(e.summaryHandle&&e.summaryHandle(o.length),0===o.length)return void e.completion(a.BLE_RET.status.suc,[]);var i=[],c=function(t,n){n.summary=o[t],e.everyReportHandle&&(e.everyReportHandle(t,o.length,n),i.push(n))};s.log.i("downloadHistoryData start");var u=function(t){s.log.i("downloadHistoryData complete"),e.completion&&e.completion(t,i)};t.downloadReports(o,e.evDataEnable,0,c,u)},r={starttime:e.startTime,endtime:e.endTime,handler:n};this.querySummery(r)},(new r).initBle(void 0,!1,function(){})},function(e,t,n){"use strict";function r(){this.conf=p}t.a=r;var o=n(8),i=n(5),a=n(0),s=n(1),c=n(2),u=n(4),l=[],f=[],_=[],d=[],h=[],g="bleCommonApi2",p=o.MedicaBle.getBleDefaultConfig();p.protocol=new i.MedicaProtocol2,r.prototype=new o.MedicaBle,r.prototype.getDeviceInfo=function(e){this.getDeviceSystemInfo(e)},r.prototype.parsePost=function(e){if(e){var t=s.default.buffer2Arr(e.buffer);switch(a.log.i(g,"parsePost msgType:"+e.msgType+", buffer:",e.buffer),e.msgType){case 26:var n=t[0],r=-1;if(0==n&&(r=t[1]),l)for(var o=0,i=l.length;o<i;o++)l[o]?l[o](n,r):(l.splice(o,1),o--,i=l.length);break;case 28:var c=t[0],u=-1,p=0;if(0==c&&(u=t[1],p=t[2]),_)for(var E=0,v=_.length;E<v;E++)_[E]?_[E](c,u,p):(_.splice(E,1),E--,v=_.length);break;case 7:for(var B=new DataView(e.buffer.slice(11,e.buffer.byteLength)),D=(B.get4x(),B.get2x(),255&B.get2x()),y=255&B.get1x(),b=new Array,A=0;A<y;A++){b[A]=new Array;for(var C=0;C<2;C++)b[A][C]=B.get1x()}for(var T=new Array,w=0;w<D;w++){T[w]=new Array;for(var M=0;M<y;M++)switch(b[M][1]){case 1:T[w][M]=255&B.get1x();break;case 2:T[w][M]=65535&B.get2x();break;case 4:T[w][M]=B.get4x()}}for(var m=new Array,I=0,O=T.length;I<O;I++){for(var P={},S=0;S<T[I].length;S++)switch(b[S][0]){case 0:P.breathRate=T[I][S];break;case 1:P.heartRate=T[I][S];break;case 2:P.status=T[I][S];break;case 48:case 49:case 50:break;case 5:P.sleepFlag=T[I][S];break;case 6:P.wakeFlag=T[I][S];break;case 16:P.temp=100*T[I][S];break;case 17:P.humidity=T[I][S]}m[I]=P}if(f)for(var R=0,L=f.length;R<L;R++)f[R]?f[R](m):(f.splice(R,1),R--,L=f.length);break;case 5:for(var x=new DataView(e.buffer.slice(11,e.buffer.byteLength)),U=255&x.get1x(),k=new Array,N=0;N<U;N++)k[N]=new Object,k[N].status=x.get1x(),k[N].Value=x.get1x();if(d)for(var V=0,F=d.length;V<F;V++)d[V]?d[V](k):(d.splice(V,1),V--,F=d.length);break;case 29:for(var W=new DataView(e.buffer.slice(11,e.buffer.byteLength)),K=(W.get4x(),W.get2x(),255&W.get2x()),Y=new Array,j=0;j<K;j++)Y.push(W.get2x());if(h)for(var q=0,G=h.length;q<G;q++)h[q]?h[q](Y):(h.splice(q,1),q--,G=h.length)}}},r.prototype.registCollectionStatusCallback=function(e){if(e&&"function"==typeof e){var t=d.length;d[t]=e}},r.prototype.unRegistCollectionStatusCallback=function(e){if(e&&"function"==typeof e)for(var t=d.length,n=0;n<t;n++)if(d[n]==e){d.splice(n,1);break}},r.prototype.registDeviceStatusCallback=function(e){if(e&&"function"==typeof e){var t=l.length;l[t]=e}},r.prototype.unregistDeviceStatusCallback=function(e){if(e&&"function"==typeof e)for(var t=l.length,n=0;n<t;n++)if(l[n]==e){l.splice(n,1);break}},r.prototype.registRealtimeDataCallback=function(e){if(e&&"function"==typeof e){var t=f.length;f[t]=e}a.log.i(g,"registRealtimeDataCallback",e,f)},r.prototype.unregistRealtimeDataCallback=function(e){if(e&&"function"==typeof e)for(var t=f.length,n=0;n<t;n++)if(f[n]==e){f.splice(n,1);break}a.log.i(g,"unregistRealtimeDataCallback",e,f)},r.prototype.registOriginalDataCallback=function(e){if(e&&"function"==typeof e){var t=h.length;h[t]=e}a.log.i(g,"registOriginalDataCallback",e,h)},r.prototype.unregistOriginalDataCallback=function(e){if(e&&"function"==typeof e)for(var t=h.length,n=0;n<t;n++)if(h[n]==e){h.splice(n,1);break}a.log.i(g,"unregistOriginalDataCallback",e,h)},r.prototype.registElectCallback=function(e){if(e&&"function"==typeof e){var t=_.length;_[t]=e}a.log.i(g,"registElectCallback",e,_)},r.prototype.unregistElectCallback=function(e){if(e&&"function"==typeof e)for(var t=_.length,n=0;n<t;n++)if(_[n]==e){_.splice(n,1);break}a.log.i(g,"unregistElectCallback",e,_)},r.prototype.login=function(e){for(var t=new ArrayBuffer(30),n=new DataView(t),r=s.default.str2ab(e.deviceId),o=new DataView(r),i=0;i<13;i++)n.set1x(o.getInt8(i));var a=new Date,u=parseInt(a.valueOf()/1e3),l=-60*a.getTimezoneOffset();n.set4x(e.timestamp||u),n.set1x(2),n.set1x(2),n.set1x(4),n.set1x(3),n.set1x(4),n.set4x(e.userId),n.set4x(e.timezone||l),e.content=n.buffer,this.sendMsgOperation(0,c.FRAME_TYPE.Request,e)},r.prototype.postNotify=function(e){var t=new ArrayBuffer(3),n=new DataView(t);n.set1x(1),n.set1x(e.operationType),n.set1x(e.value||0),e.content=n.buffer,this.sendMsgOperation(6,c.FRAME_TYPE.POST,e)},r.prototype.querySummery=function(e){var t=new ArrayBuffer(9),n=new DataView(t);n.set1x(0),n.set4x(e.starttime),n.set4x(e.endtime),e.content=n.buffer,this.sendMsgOperation(9,c.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});t.count=e.getUint16(13),t.dataList=new Array;for(var n=0;n<t.count;n++){var r={};r.startTime=e.getUint32(11*n+15),r.timeStep=e.getUint16(11*n+15+4),r.recordCount=e.getUint32(11*n+15+4+2),r.stopMode=e.getUint8(11*n+15+4+2+4),t.dataList.push(r)}return t})},r.prototype.downloadHistoryData=function(e){var t=new ArrayBuffer(19),n=new DataView(t);n.set4x(e.starttime),n.set4x(e.offset),n.set2x(e.count),n.set1x(4),n.set1x(0),n.set1x(1),n.set1x(1),n.set1x(1),n.set1x(2),n.set1x(1),n.set1x(3),n.set1x(1),e.content=n.buffer,this.sendMsgOperation(11,c.FRAME_TYPE.Request,e,function(e){var t={};t.starttime=e.getUint32(12),t.offset=e.getUint32(16),t.count=e.getUint16(20),t.heartRate=new Array,t.breathRate=new Array,t.status=new Array,t.statusValue=new Array;for(var n=0;n<t.count;n++)t.breathRate[n]=e.getUint8(4*n+31),t.heartRate[n]=e.getUint8(4*n+31+1),t.status[n]=e.getUint8(4*n+31+1+1),t.statusValue[n]=e.getUint8(4*n+31+1+1+1);return t})},r.prototype.getVersionInfo=function(e){this.sendMsgOperation(20,c.FRAME_TYPE.Request,e,function(e){var t={};return t.hardMajor=e.getUint8(12),t.hardMinor=e.getUint8(13),t.softMajor=e.getUint8(14),t.softMinor=e.getUint8(15),t})},r.prototype.sendUpdateSummery=function(e){var t=new ArrayBuffer(17),n=new DataView(t);n.set1x(0),n.set1x(e.hardMajor),n.set1x(e.hardMinor),n.set1x(e.softMajor),n.set1x(e.softMinor),n.set4x(e.length),n.set4x(e.encryCrc),n.set4x(e.originCrc),e.content=n.buffer,this.sendMsgOperation(21,c.FRAME_TYPE.Request,e,function(e){return e.getUint16(12)})},r.prototype.sendUpdateDetail=function(e){var t=new ArrayBuffer(7+e.bufferArr.length),n=new DataView(t);n.set1x(1),n.set4x(e.offset),n.set2x(e.length);for(var r=0;r<e.bufferArr.length;r++)n.set1x(e.bufferArr[r]);e.content=n.buffer,this.sendMsgOperation(21,c.FRAME_TYPE.Request,e,function(e){return e.getUint16(12)})},r.prototype.setCollectStatus=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set4x(e.timestamp),n.set1x(e.status),e.content=n.buffer,this.sendMsgOperation(25,c.FRAME_TYPE.Request,e)},r.prototype.getCollectStatus=function(e){this.sendMsgOperation(26,c.FRAME_TYPE.Request,e,function(e){return e.getUint8(12)})},r.prototype.getDeviceSystemInfo=function(e){e.content=new ArrayBuffer(0),this.sendMsgOperation(27,c.FRAME_TYPE.Request,e,function(e){var t=(Array.prototype.slice.call(new Uint8Array(e.buffer)),{});return t.hardMajor=e.getUint8(12),t.hardMinor=e.getUint8(13),t.hardVersion=Object(u.padStart)(t.hardMajor,1)+"."+Object(u.padStart)(t.hardMinor),t.softMajor=e.getUint8(14),t.softMinor=e.getUint8(15),t.softVersion=Object(u.padStart)(t.softMajor,1)+"."+Object(u.padStart)(t.softMinor),t.producedDate=e.getUint16(16),t.deviceId=s.default.buf2string(e.buffer.slice(20,33)),t})},r.prototype.getBattery=function(e){this.sendMsgOperation(28,c.FRAME_TYPE.Request,e,function(e){var t={};return t.status=e.getUint8(12),t.battery=e.getUint8(13),t})},r.prototype.setAutoMonitor=function(e){var t=new ArrayBuffer(4),n=new DataView(t);n.set1x(e.flag),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.weekday),e.content=n.buffer,this.sendMsgOperation(30,c.FRAME_TYPE.Request,e)},r.prototype.getAutoMonitor=function(e){this.sendMsgOperation(31,c.FRAME_TYPE.Request,e,function(e){var t={};return t.flag=e.getUint8(12),t.hour=e.getUint8(13),t.minute=e.getUint8(14),t.weekday=e.getUint8(15),t})},r.prototype.setSmartClock=function(e){var t=new ArrayBuffer(5),n=new DataView(t);n.set1x(e.flag),n.set1x(e.offset),n.set1x(e.hour),n.set1x(e.minute),n.set1x(e.weekday),e.content=n.buffer,this.sendMsgOperation(32,c.FRAME_TYPE.Request,e)},r.prototype.getSmartClock=function(e){this.sendMsgOperation(33,c.FRAME_TYPE.Request,e,function(e){var t={};return t.flag=e.getUint8(12),t.offset=e.getUint8(13),t.hour=e.getUint8(14),t.minute=e.getUint8(15),t.weekday=e.getUint8(16),t})},r.prototype.sendMsgOperation=function(e,t,n,r){var o={content:n.content||new ArrayBuffer(0),timeout:n.timeout||1e4,msgType:e,frameType:t,handler:function(e,t,o){var i;if(e!=c.BLE_RET.status.suc)n.handler&&n.handler(e);else if(n.handler){null==t&&(t=new ArrayBuffer(0));var a,s=new DataView(t);a=o.frameType==c.FRAME_TYPE.ACK?s.getInt8(8):s.getInt8(11),0!=a?n.handler(e):r?(i=r(s),n.handler(c.BLE_RET.status.suc,i)):n.handler(c.BLE_RET.status.suc)}}};this.sendPacket(o)}}])});